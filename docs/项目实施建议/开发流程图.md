# é¡¹ç›®å¼€å‘å®æ–½æŒ‡å—

> å®Œæ•´çš„é¡¹ç›®å¼€å‘æµç¨‹ï¼Œä»å¯åŠ¨åˆ°å‘å¸ƒçš„ç³»ç»ŸåŒ–å®è·µæŒ‡å—

---

## å®Œæ•´æµç¨‹å›¾

```mermaid
flowchart TB
    Start([é¡¹ç›®å¯åŠ¨]) --> ScenarioCheck{åœºæ™¯åˆ¤æ–­}

    %% é˜¶æ®µ1ï¼šé¡¹ç›®åˆå§‹åŒ–
    subgraph Phase1 [é˜¶æ®µ1ï¼šé¡¹ç›®åˆå§‹åŒ– Day 0]
        direction TB
        ScenarioCheck -->|åœºæ™¯A: ä»é›¶å¼€å§‹| FullInterview[å®Œæ•´äº”ç»´åº¦è®¿è°ˆ<br/>2-4å°æ—¶]
        ScenarioCheck -->|åœºæ™¯B: å·²æœ‰èµ„æ–™| MappingInterview[èµ„æ–™æ˜ å°„+è¡¥å…¨è®¿è°ˆ<br/>1-2å°æ—¶]
        ScenarioCheck -->|åœºæ™¯C: å·²æœ‰é¡¹ç›®| RepomixAnalysis[ğŸ” Repomix MCP åˆ†æä»£ç åº“<br/>è¯†åˆ«æŠ€æœ¯æ ˆ+æ¶æ„+é…ç½®<br/>30åˆ†é’Ÿ]

        FullInterview --> GenerateADR[ç”ŸæˆADRæ–‡æ¡£<br/>ADR-001: æŠ€æœ¯æ ˆ<br/>ADR-002: æ¶æ„<br/>ADR-003: è´¨é‡]
        MappingInterview --> GenerateADR
        RepomixAnalysis --> GenerateADR

        GenerateADR --> AutoConfigCheck[ğŸ”§ è‡ªåŠ¨é…ç½®æ£€æŸ¥<br/>npm run check-config]

        AutoConfigCheck --> ConfigOK{æ£€æŸ¥é€šè¿‡?}
        ConfigOK -->|å¦| FixConfig[ä¿®å¤é…ç½®<br/>æŒ‰è„šæœ¬æç¤ºä¿®æ”¹]
        FixConfig --> AutoConfigCheck

        ConfigOK -->|æ˜¯| InitProject[åˆå§‹åŒ–é¡¹ç›®ç»“æ„<br/>CIé…ç½®/Git hooks/ä»»åŠ¡è¿è¡Œå™¨]
        InitProject --> CreateMilestone[åˆ›å»ºGitHub Milestone v0.1<br/>å®šä¹‰ç‰ˆæœ¬ç›®æ ‡å’Œå®Œæˆæ ‡å‡†]
        CreateMilestone --> FirstCommit([ç¬¬ä¸€æ¬¡æäº¤:<br/>chore: initial project structure])
    end

    FirstCommit --> VersionLoop

    %% é˜¶æ®µ2ï¼šç‰ˆæœ¬å¼€å‘å¾ªç¯
    subgraph Phase2 [é˜¶æ®µ2ï¼šç‰ˆæœ¬å¼€å‘å¾ªç¯]
        direction TB

        CheckMilestone[æ£€æŸ¥å½“å‰Milestone<br/>gh milestone view]
        CheckMilestone --> CreateIssues[åˆ›å»ºGitHub Issues<br/>å¸¦éªŒæ”¶æ ‡å‡†ï¼Œå…³è”Milestone]

        CreateIssues --> FeatureLoop

        %% åŠŸèƒ½å¼€å‘å¾ªç¯
        subgraph FeatureLoop [åŠŸèƒ½å¼€å‘å¾ªç¯]
            direction TB
            CheckIssues{Milestoneä¸­<br/>è¿˜æœ‰æœªå®ŒæˆIssue?}

            CheckIssues -->|æ˜¯| CreateBranch[åˆ›å»ºfeatureåˆ†æ”¯<br/>feature/issueId-description]

            CreateBranch --> Development[å¼€å‘ + é¢‘ç¹æœ¬åœ°æäº¤<br/>éµå¾ªä»£ç è§„èŒƒ]

            Development --> LocalQuality[æœ¬åœ°è´¨é‡æ£€æŸ¥<br/>IDEæ£€æŸ¥ + Git hooks]

            LocalQuality --> CreatePR[åˆ›å»ºPull Request<br/>å¦‚æœ‰å†²çªï¼Œå…ˆrebaseè§£å†³]
            CreatePR --> RemoteCI{è¿œç¨‹CIæ£€æŸ¥}
            RemoteCI -->|å¤±è´¥| FixCode[ä¿®å¤é—®é¢˜]
            FixCode --> Development

            RemoteCI -->|é€šè¿‡| CodeReview{Code Review}
            CodeReview -->|éœ€ä¿®æ”¹| FixCode
            CodeReview -->|é€šè¿‡| Merge[åˆå¹¶ merge commit<br/>å…³é—­Issue]

            Merge --> CheckIssues
            CheckIssues -->|å¦| ExitFeatureLoop
        end

        ExitFeatureLoop --> MilestoneComplete{Milestoneå®Œæˆ?<br/>æŸ¥çœ‹è‡ªåŠ¨è¿›åº¦æ¡}

        MilestoneComplete -->|å¦| CreateIssues
        MilestoneComplete -->|æ˜¯| ReleaseVersion[æ‰§è¡Œå‘å¸ƒ<br/>./scripts/release.sh 0.x.y]

        ReleaseVersion --> CreateTag[æ‰“Git Tag v0.x.y]
        CreateTag --> GitHubRelease[åˆ›å»ºGitHub Release]
        GitHubRelease --> UpdateChangelog[æ›´æ–°CHANGELOG.md]
        UpdateChangelog --> CloseMilestone[å…³é—­Milestone<br/>gh milestone close]

        CloseMilestone --> ProjectContinue{é¡¹ç›®ç»§ç»­?}
        ProjectContinue -->|æ˜¯| CreateNewMilestone[åˆ›å»ºæ–°Milestone v0.x+1<br/>å®šä¹‰ä¸‹ä¸€ç‰ˆæœ¬ç›®æ ‡]
        CreateNewMilestone --> CheckMilestone
        ProjectContinue -->|å¦| ExitVersionLoop
    end

    ExitVersionLoop --> Phase3

    %% é˜¶æ®µ3ï¼šé¡¹ç›®æ”¶å°¾
    subgraph Phase3 [é˜¶æ®µ3ï¼šé¡¹ç›®æ”¶å°¾]
        direction TB
        FinalDocs[æœ€ç»ˆæ–‡æ¡£æ›´æ–°<br/>å®Œå–„README/APIæ–‡æ¡£]
        FinalDocs --> KnowledgeSummary[çŸ¥è¯†æ€»ç»“<br/>æŠ€æœ¯å¤ç›˜]
        KnowledgeSummary --> ProjectArchive[é¡¹ç›®å½’æ¡£]
    end

    ProjectArchive --> End([é¡¹ç›®ç»“æŸ])

    %% æ ·å¼å®šä¹‰
    classDef criticalNode fill:#ff6b6b,stroke:#c92a2a,stroke-width:3px,color:#fff
    classDef milestoneNode fill:#51cf66,stroke:#2f9e44,stroke-width:2px,color:#000
    classDef decisionNode fill:#ffd43b,stroke:#f59f00,stroke-width:2px,color:#000
    classDef processNode fill:#74c0fc,stroke:#1971c2,stroke-width:1px,color:#000
    classDef improvedNode fill:#9775fa,stroke:#7950f2,stroke-width:2px,color:#fff

    class AutoConfigCheck,CreateMilestone,CloseMilestone,CreateNewMilestone improvedNode
    class FirstCommit,CreateTag,GitHubRelease,End milestoneNode
    class ScenarioCheck,CheckIssues,MilestoneComplete,ProjectContinue,RemoteCI,CodeReview,ConfigOK decisionNode
    class Development,LocalQuality,ReleaseVersion processNode
```

---

## å…³é”®æµç¨‹è¯´æ˜

### 0. äº”ç»´åº¦è®¿è°ˆ - æŠ€æœ¯æ ˆé€‰æ‹©ç­–ç•¥ï¼ˆç»´åº¦1 Q3ï¼‰

**ä¸ºä»€ä¹ˆéœ€è¦æ··åˆé€‰æ‹©æ–¹å¼ï¼Ÿ**

éµå¾ª Linus çš„å®ç”¨ä¸»ä¹‰å“²å­¦ï¼š"ä¸è§£å†³å‡æƒ³çš„é—®é¢˜ï¼Œåªè§£å†³çœŸå®çš„é—®é¢˜"ã€‚å¤§å¤šæ•°é¡¹ç›®ï¼ˆçº¦90%ï¼‰ä½¿ç”¨å¸¸è§æŠ€æœ¯æ ˆï¼ˆWebåç«¯ã€å‰ç«¯åº”ç”¨ã€ç§»åŠ¨åº”ç”¨ç­‰ï¼‰ï¼Œå¯é€šè¿‡å¿«é€Ÿå¤šé€‰å®ŒæˆæŠ€æœ¯æ ˆç¡®è®¤ã€‚ä½†çº¦10%çš„é¡¹ç›®ä½¿ç”¨æ–°å…´æˆ–ç‰¹æ®ŠæŠ€æœ¯ï¼ˆå¦‚ MCP æœåŠ¡å™¨ã€AI Agentã€Web3ã€åµŒå…¥å¼ï¼‰ï¼Œè¿™äº›æŠ€æœ¯æ ˆæœ‰ç‹¬ç‰¹çš„å·¥å…·é“¾å’Œæ¶æ„çº¦æŸï¼Œæ— æ³•ç”¨ç®€å•çš„"è¯­è¨€+æ¡†æ¶"æè¿°ã€‚

**è®¾è®¡åŸåˆ™**ï¼šé¿å…ä¸ºæ¯ä¸ªæ–°æŠ€æœ¯åˆ›å»ºå•ç‹¬çš„è®¿è°ˆæ¨¡æ¿ï¼ˆå¤æ‚åº¦çˆ†ç‚¸ï¼‰ï¼Œè€Œæ˜¯è®©è®¿è°ˆæœ¬èº«å…·å¤‡çµæ´»æ€§ã€‚

#### æŠ€æœ¯æ ˆé€‰æ‹©å†³ç­–æµç¨‹

```mermaid
flowchart TD
    Start[ç»´åº¦1 Q3: æŠ€æœ¯æ ˆé€‰æ‹©] --> Decision{é¡¹ç›®ç±»å‹åˆ¤æ–­}

    Decision -->|90%: å¸¸è§åœºæ™¯<br/>Web/Mobile/Desktop| Path1[æ–¹å¼1: å¿«é€Ÿé€‰æ‹©]
    Decision -->|10%: æ–°å…´åœºæ™¯<br/>MCP/AI Agent/Web3| Path2[æ–¹å¼2: å¼€æ”¾æè¿°]

    subgraph CommonStack [å¸¸è§æŠ€æœ¯æ ˆ - æ–¹å¼1]
        direction TB
        Path1 --> SelectLang[å‹¾é€‰è¯­è¨€<br/>JS/Python/Java/Rust/Go/C#/Swift]
        SelectLang --> SelectFramework[å¯é€‰: å‹¾é€‰æ¡†æ¶<br/>React/FastAPI/Spring/Gin...]
        SelectFramework --> FillReason[å¡«å†™ç†ç”±<br/>æ€§èƒ½/å›¢é˜Ÿ/ç”Ÿæ€]
    end

    subgraph NovelStack [æ–°å…´æŠ€æœ¯æ ˆ - æ–¹å¼2]
        direction TB
        Path2 --> DescLang[æ ¸å¿ƒç¼–ç¨‹è¯­è¨€<br/>å¦‚: TypeScript]
        DescLang --> DescSDK[ä¸»è¦æ¡†æ¶/SDK<br/>å¦‚: MCP SDK / LangChain]
        DescSDK --> DescTools[ç‰¹æ®Šå·¥å…·é“¾<br/>å¦‚: stdioé€šä¿¡ / å‘é‡æ•°æ®åº“]
        DescTools --> DescRef[å‚è€ƒé¡¹ç›®/æ–‡æ¡£<br/>å¦‚: @modelcontextprotocol/server-everything]
        DescRef --> DescReason[æŠ€æœ¯æ ˆé€‰æ‹©ç†ç”±<br/>è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸ºä½•é€‰è¿™ä¸ªç»„åˆï¼Ÿ]
    end

    FillReason --> Generate[ç”Ÿæˆ ADR-001<br/>æŠ€æœ¯æ ˆé€‰å‹æ–‡æ¡£]
    DescReason --> Generate

    Generate --> NextDimension[ç»§ç»­ç»´åº¦2è®¿è°ˆ<br/>æ¶æ„è®¾è®¡]

    style Decision fill:#ffd43b,stroke:#f59f00,stroke-width:2px
    style Generate fill:#51cf66,stroke:#2f9e44,stroke-width:2px
    style CommonStack fill:#e7f5ff,stroke:#1971c2,stroke-width:1px
    style NovelStack fill:#fff3bf,stroke:#f59f00,stroke-width:1px
```

#### å…¸å‹é¡¹ç›®ç±»å‹å¯¹ç…§

| é¡¹ç›®ç±»å‹           | æ¨èæ–¹å¼ | æŠ€æœ¯æ ˆç¤ºä¾‹                     | å…³é”®å·®å¼‚                                          |
| ------------------ | -------- | ------------------------------ | ------------------------------------------------- |
| **Web åç«¯ API**   | æ–¹å¼1    | Python + FastAPI               | å‹¾é€‰è¯­è¨€å’Œæ¡†æ¶å³å¯ï¼Œæ ‡å‡†åŒ–ç¨‹åº¦é«˜                  |
| **React å‰ç«¯åº”ç”¨** | æ–¹å¼1    | TypeScript + React + Vite      | ç”Ÿæ€æˆç†Ÿï¼Œé€‰é¡¹åˆ—è¡¨è¦†ç›–å®Œæ•´                        |
| **MCP æœåŠ¡å™¨**     | æ–¹å¼2    | TypeScript + MCP SDK + stdio   | éœ€æè¿°ç‰¹æ®Šå·¥å…·ï¼šstdioé€šä¿¡ã€MCP Inspectorè°ƒè¯•      |
| **AI Agent**       | æ–¹å¼2    | Python + LangChain + Chroma    | éœ€æè¿°ï¼šå‘é‡æ•°æ®åº“ã€Promptç‰ˆæœ¬æ§åˆ¶ã€LangSmithè¿½è¸ª |
| **ç§»åŠ¨åº”ç”¨**       | æ–¹å¼1    | Kotlin + Jetpack Compose       | æ¡†æ¶é€‰é¡¹å·²é¢„å®šä¹‰                                  |
| **Web3 DApp**      | æ–¹å¼2    | Solidity + Hardhat + Ethers.js | éœ€æè¿°ï¼šæ™ºèƒ½åˆçº¦å·¥å…·é“¾ã€æµ‹è¯•ç½‘ç»œã€IPFS            |
| **åµŒå…¥å¼ç³»ç»Ÿ**     | æ–¹å¼2    | C + FreeRTOS + HALåº“           | éœ€æè¿°ï¼šç¡¬ä»¶æŠ½è±¡å±‚ã€RTOSã€è°ƒè¯•å™¨                  |

#### å®è·µå»ºè®®

1. **é»˜è®¤å…ˆå°è¯•æ–¹å¼1**ï¼šå¦‚æœä½ çš„é¡¹ç›®èƒ½åœ¨"è¯­è¨€é€‰æ‹©"å’Œ"æ¡†æ¶é€‰æ‹©"çš„åˆ—è¡¨ä¸­æ‰¾åˆ°åŒ¹é…é¡¹ï¼Œç›´æ¥å‹¾é€‰å³å¯ã€‚

2. **è¯†åˆ«æ–¹å¼2çš„ä¿¡å·**ï¼š
   - âœ… é¡¹ç›®ä¾èµ–ç‰¹æ®Šåè®®ï¼ˆå¦‚ MCPã€gRPCã€MQTTï¼‰
   - âœ… éœ€è¦ç‰¹æ®Šè°ƒè¯•å·¥å…·ï¼ˆå¦‚ MCP Inspectorã€LangSmithã€Hardhat Consoleï¼‰
   - âœ… æŠ€æœ¯æ ˆåŒ…å«"åè®®+SDK+å·¥å…·é“¾"ç»„åˆï¼Œè€Œéç®€å•çš„"è¯­è¨€+æ¡†æ¶"
   - âœ… æ— æ³•ç”¨ä¸€å¥è¯æ¦‚æ‹¬æŠ€æœ¯æ ˆï¼ˆå¦‚"å°±æ˜¯ä¸ªReactåº”ç”¨" vs "åŸºäºstdioçš„MCPæœåŠ¡å™¨"ï¼‰

3. **æ–¹å¼2çš„æ ¸å¿ƒä»·å€¼**ï¼š"å‚è€ƒé¡¹ç›®/æ–‡æ¡£"å­—æ®µ
   - å¸®åŠ© AI ç†è§£æ¶æ„çº¦æŸï¼ˆå¦‚ MCP å¿…é¡»ç”¨ stdio é€šä¿¡ï¼‰
   - æä¾›æœ€ä½³å®è·µå‚è€ƒï¼ˆå¦‚ LangChain å®˜æ–¹æ¨¡æ¿çš„ç›®å½•ç»“æ„ï¼‰
   - é¿å…è¿ååè®®è§„èŒƒï¼ˆå¦‚ MCP çš„ JSON-RPC æ ¼å¼è¦æ±‚ï¼‰

4. **ä¸¤ç§æ–¹å¼çš„ADRè¾“å‡ºä¸€è‡´**ï¼šæ— è®ºç”¨å“ªç§æ–¹å¼ï¼Œæœ€ç»ˆéƒ½ç”Ÿæˆæ ‡å‡†åŒ–çš„ ADR-001 æ–‡æ¡£ï¼ŒåŒ…å«æŠ€æœ¯æ ˆé€‰æ‹©å’Œç†ç”±ã€‚

---

### 1. GitHub Milestone ç‰ˆæœ¬ç®¡ç†

ä½¿ç”¨ GitHub Milestone ç®¡ç†ç‰ˆæœ¬è§„åˆ’ï¼Œè‡ªåŠ¨è¿½è¸ªè¿›åº¦ã€‚

**åˆ›å»ºç‰ˆæœ¬ Milestoneï¼š**

```bash
# åˆ›å»ºç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„ Milestone
gh milestone create "v0.1.0" \
  --description "æ ¸å¿ƒç›®æ ‡ï¼š
  1. ç”¨æˆ·è®¤è¯åŠŸèƒ½
  2. æ•°æ®å¯¼å…¥å¯¼å‡º

  å®Œæˆæ ‡å‡†ï¼š
  - æ‰€æœ‰P0 bugä¿®å¤
  - CIé€šè¿‡ç‡ >95%
  - æ ¸å¿ƒAPIæ–‡æ¡£å®Œæˆ" \
  --due-date "2025-02-15"
```

**åˆ›å»º Issue å¹¶å…³è” Milestoneï¼š**

```bash
gh issue create \
  --title "å®ç°OAuth2ç™»å½•" \
  --body "å®ç°Google/GitHub OAuth2ç™»å½•æµç¨‹" \
  --milestone "v0.1.0" \
  --label "p1,enhancement"
```

**æŸ¥çœ‹ Milestone è¿›åº¦ï¼š**

```bash
# åˆ—å‡ºæ‰€æœ‰ Milestone åŠè¿›åº¦
gh milestone list
# è¾“å‡º: v0.1.0  7/10 (70%)  Feb 15, 2025

# æŸ¥çœ‹å…·ä½“ Milestone çš„æ‰€æœ‰ Issue
gh milestone view "v0.1.0"
```

**ç‰ˆæœ¬å®Œæˆåï¼š**

```bash
# å…³é—­å½“å‰ Milestone
gh milestone close "v0.1.0"

# åˆ›å»ºä¸‹ä¸€ä¸ªç‰ˆæœ¬
gh milestone create "v0.2.0" \
  --description "ä¸‹ä¸€ç‰ˆæœ¬ç›®æ ‡..." \
  --due-date "2025-03-30"
```

---

### 2. é…ç½®è‡ªåŠ¨æ£€æŸ¥

åœ¨ Day 0 é¡¹ç›®åˆå§‹åŒ–æ—¶ï¼Œè¿è¡Œè‡ªåŠ¨æ£€æŸ¥è„šæœ¬ç¡®ä¿é…ç½®å®Œæ•´ã€‚

**åˆ›å»ºæ£€æŸ¥è„šæœ¬ï¼š`scripts/check-config.sh`**

```bash
#!/bin/bash
set -e

echo "ğŸ” æ£€æŸ¥é…ç½®å®Œæ•´æ€§..."

# æ£€æŸ¥1: .prettierignore å­˜åœ¨
if [ ! -f .prettierignore ]; then
  echo "âŒ .prettierignore ä¸å­˜åœ¨"
  exit 1
fi
echo "âœ… .prettierignore å­˜åœ¨"

# æ£€æŸ¥2: æ ¼å¼åŒ–å‘½ä»¤è¦†ç›–æ•´ä¸ªé¡¹ç›®
FMT_CMD=$(grep -A 1 '"fmt"' package.json | tail -n 1)
if [[ ! $FMT_CMD =~ "\*\*/\*" ]]; then
  echo "âŒ æ ¼å¼åŒ–å‘½ä»¤åº”ä½¿ç”¨ **/* è€Œé {src}/**/*"
  exit 1
fi
echo "âœ… æ ¼å¼åŒ–å‘½ä»¤è¦†ç›–æ•´ä¸ªé¡¹ç›®"

# æ£€æŸ¥3: lint-staged è·¯å¾„åŒ¹é… tsconfig.json
if [ -f tsconfig.json ] && [ -f .lintstagedrc.json ]; then
  echo "âœ… lint-staged é…ç½®å­˜åœ¨"
fi

# æ£€æŸ¥4: Git hooks é…ç½®
if [ -f .husky/pre-commit ] || [ -f .git/hooks/pre-commit ] || [ -f .pre-commit-config.yaml ]; then
  echo "âœ… Git hooks é…ç½®å®Œæ•´"
else
  echo "âŒ Git hooks é…ç½®ç¼ºå¤±"
  exit 1
fi

# æ£€æŸ¥5: CI é…ç½®
if [ -f .github/workflows/ci.yml ]; then
  echo "âœ… CI é…ç½®æ–‡ä»¶å­˜åœ¨"
else
  echo "âŒ CI é…ç½®æ–‡ä»¶ç¼ºå¤±"
  exit 1
fi

echo ""
echo "ğŸ‰ æ‰€æœ‰é…ç½®æ£€æŸ¥é€šè¿‡ï¼"
```

**åœ¨ package.json ä¸­æ·»åŠ ï¼š**

```json
{
  "scripts": {
    "check-config": "./scripts/check-config.sh"
  }
}
```

**ä½¿ç”¨æ–¹å¼ï¼š**

```bash
# åˆå§‹åŒ–é¡¹ç›®åè¿è¡Œ
npm run check-config

# å¦‚æœå¤±è´¥ï¼ŒæŒ‰æç¤ºä¿®å¤ï¼Œå†æ¬¡è¿è¡Œ
```

---

### 3. è´¨é‡æ£€æŸ¥æµç¨‹

**ä¸¤å±‚é˜²æŠ¤ä½“ç³»ï¼š**

```
Layer 1: æœ¬åœ°å¿«é€Ÿæ£€æŸ¥
  - IDE å®æ—¶æ£€æŸ¥
  - pre-commit: fmt + lint (<5ç§’)
  - pre-push: å¿«é€Ÿç±»å‹æ£€æŸ¥ (<30ç§’)

Layer 2: è¿œç¨‹å®Œæ•´æ£€æŸ¥
  - å®Œæ•´ CI: fmt + lint + test + build
```

**å·¥ä½œæµï¼š**

1. **å¼€å‘æ—¶**ï¼šIDE å®æ—¶æ£€æŸ¥è¯­æ³•é”™è¯¯å’Œç±»å‹é—®é¢˜
2. **æäº¤æ—¶**ï¼šGit pre-commit hook è‡ªåŠ¨æ ¼å¼åŒ–å’Œ lint
3. **æ¨é€å‰**ï¼šGit pre-push hook è¿è¡Œå¿«é€Ÿç±»å‹æ£€æŸ¥
4. **PR åˆ›å»ºå**ï¼šè¿œç¨‹ CI è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶

---

### 4. å¼‚å¸¸åœºæ™¯å¤„ç†

#### 4.1 åˆå¹¶å†²çªå¤„ç†

**åœºæ™¯ï¼š** åˆ›å»º PR æ—¶æç¤º"å­˜åœ¨å†²çªï¼Œæ— æ³•è‡ªåŠ¨åˆå¹¶"

è¿™æ˜¯å¤šäººåä½œä¸­çš„å¸¸è§åœºæ™¯ï¼šä½ çš„ feature branch å¼€å‘äº† 2-3 å¤©ï¼ŒæœŸé—´ main åˆ†æ”¯æœ‰å…¶ä»– PR åˆå¹¶ï¼Œå¯¼è‡´ä»£ç å†²çªã€‚

**è§£å†³æ­¥éª¤ï¼š**

```bash
# æ­¥éª¤ 1: åˆ‡æ¢åˆ°ä½ çš„ feature åˆ†æ”¯
git checkout feature/42-user-auth

# æ­¥éª¤ 2: åŒæ­¥ main åˆ†æ”¯çš„æœ€æ–°ä»£ç ï¼ˆä½¿ç”¨ rebase ä¿æŒå†å²æ•´æ´ï¼‰
git pull --rebase origin main

# æ­¥éª¤ 3: å¦‚æœæœ‰å†²çªï¼ŒGit ä¼šæç¤ºå†²çªæ–‡ä»¶
# Auto-merging src/auth.ts
# CONFLICT (content): Merge conflict in src/auth.ts

# æ­¥éª¤ 4: æ‰“å¼€å†²çªæ–‡ä»¶ï¼Œæ‰‹åŠ¨è§£å†³å†²çª
# æŸ¥æ‰¾ <<<<<<< HEAD å’Œ >>>>>>> æ ‡è®°
# ä¿ç•™éœ€è¦çš„ä»£ç ï¼Œåˆ é™¤å†²çªæ ‡è®°

# æ­¥éª¤ 5: æ ‡è®°å†²çªå·²è§£å†³
git add src/auth.ts

# æ­¥éª¤ 6: ç»§ç»­ rebase
git rebase --continue

# æ­¥éª¤ 7: æ¨é€åˆ°è¿œç¨‹ï¼ˆéœ€è¦ forceï¼Œå› ä¸º rebase æ”¹å˜äº†å†å²ï¼‰
git push --force-with-lease origin feature/42-user-auth
```

**æœ€ä½³å®è·µï¼š**

- âœ… **Feature branch ç”Ÿå‘½å‘¨æœŸä¸è¶…è¿‡ 2-3 å¤©**ï¼šé•¿æœŸåˆ†æ”¯å®¹æ˜“ç´¯ç§¯å†²çª
- âœ… **æ¯å¤©åŒæ­¥ main**ï¼š`git pull --rebase origin main`ï¼ŒåŠæ—©å‘ç°å†²çª
- âœ… **å¤§åŠŸèƒ½æ‹†åˆ†ä¸ºå¤šä¸ªå° Issue**ï¼šç¬¦åˆ Linus çš„"ç®€æ´"å“²å­¦
- âœ… **ä½¿ç”¨ `--force-with-lease`**ï¼šæ¯” `--force` æ›´å®‰å…¨ï¼Œä¸ä¼šè¦†ç›–åˆ«äººçš„æ¨é€

#### 4.2 Hotfix ç´§æ€¥ä¿®å¤æµç¨‹

**åœºæ™¯ï¼š** ç”Ÿäº§ç¯å¢ƒ v0.2.0 å‘ç°ä¸¥é‡ bugï¼Œè€Œ main åˆ†æ”¯å·²æœ‰ v0.3.0 çš„æ–°åŠŸèƒ½ï¼ˆä¸èƒ½ç›´æ¥å‘å¸ƒï¼‰

è¿™æ˜¯å‘åä¿®å¤çš„çœŸå®åœºæ™¯ï¼ŒLinux å†…æ ¸çš„ç¨³å®šç‰ˆæœ¬ç»´æŠ¤å°±æ˜¯è¿™æ ·åšçš„ã€‚

**Hotfix æµç¨‹å›¾ï¼š**

```mermaid
flowchart LR
    ProductionBug[ğŸ”¥ ç”Ÿäº§ç¯å¢ƒBug] --> CheckoutTag[ä»release tag<br/>åˆ›å»ºhotfixåˆ†æ”¯]
    CheckoutTag --> FixBug[ä¿®å¤bug<br/>+ æ·»åŠ æµ‹è¯•]
    FixBug --> TestFix[æœ¬åœ°æµ‹è¯•éªŒè¯]
    TestFix --> ReleaseHotfix[å‘å¸ƒpatchç‰ˆæœ¬<br/>v0.2.1]
    ReleaseHotfix --> CheckMain{âš ï¸ mainåˆ†æ”¯<br/>æ˜¯å¦é‡æ„ç›¸å…³ä»£ç ?}

    CheckMain -->|æƒ…å†µA: æœªé‡æ„| MergeCommit[ä½¿ç”¨ merge --no-ff<br/>ä¿ç•™å®Œæ•´ä¸Šä¸‹æ–‡]
    CheckMain -->|æƒ…å†µB: å·²é‡æ„<br/>ä¼šäº§ç”Ÿå¤§é‡å†²çª| CherryPick[ä½¿ç”¨ cherry-pick<br/>åªæå–bugä¿®å¤commit]

    MergeCommit --> DeleteBranch[åˆ é™¤hotfixåˆ†æ”¯<br/>æ¨é€åˆ°è¿œç¨‹]
    CherryPick --> DeleteBranch

    style ProductionBug fill:#ff6b6b,stroke:#c92a2a,stroke-width:2px,color:#fff
    style CheckMain fill:#ffd43b,stroke:#f59f00,stroke-width:2px,color:#000
    style DeleteBranch fill:#51cf66,stroke:#2f9e44,stroke-width:2px
```

**è¯¦ç»†æ­¥éª¤ï¼š**

```bash
# æ­¥éª¤ 1: ä»æœ‰é—®é¢˜çš„ release tag åˆ›å»º hotfix åˆ†æ”¯
git checkout -b hotfix/0.2.1 v0.2.0

# æ­¥éª¤ 2: ä¿®å¤ bug
# ç¼–è¾‘ä»£ç ...
git add src/data-handler.ts
git commit -m "fix: prevent data loss in edge case (Fixes #123)"

# æ­¥éª¤ 3: æ·»åŠ æµ‹è¯•ï¼Œé¿å… bug é‡ç°
git add tests/data-handler.test.ts
git commit -m "test: add test case for data loss scenario"

# æ­¥éª¤ 4: æœ¬åœ°éªŒè¯ä¿®å¤
npm run test
npm run build

# æ­¥éª¤ 5: æ¨é€ hotfix åˆ†æ”¯
git push origin hotfix/0.2.1

# æ­¥éª¤ 6: å‘å¸ƒ patch ç‰ˆæœ¬ï¼ˆä½¿ç”¨ release è„šæœ¬ï¼‰
./scripts/release.sh 0.2.1

# æ­¥éª¤ 7: ğŸ”´ å…³é”®æ­¥éª¤ï¼šå°†ä¿®å¤åˆå¹¶å› mainï¼ˆæ ¹æ®æƒ…å†µé€‰æ‹©ï¼‰

# æƒ…å†µAï¼šmainåˆ†æ”¯æœªé‡æ„ç›¸å…³ä»£ç ï¼ˆæ¨èä½¿ç”¨mergeï¼‰
git checkout main
git pull origin main
git merge hotfix/0.2.1 --no-ff  # ä½¿ç”¨ merge commit ä¿ç•™ä¸Šä¸‹æ–‡
git push origin main

# æƒ…å†µBï¼šmainåˆ†æ”¯å·²é‡æ„ï¼Œç›´æ¥mergeä¼šäº§ç”Ÿå¤§é‡å†²çªï¼ˆä½¿ç”¨cherry-pickï¼‰
git checkout main
git pull origin main
git log hotfix/0.2.1  # æ‰¾åˆ°bugä¿®å¤çš„commit hash
git cherry-pick <commit-hash>  # åªæå–bugä¿®å¤commit
# å¦‚æœæœ‰å†²çªï¼Œæ‰‹åŠ¨è§£å†³åï¼š
# git add .
# git cherry-pick --continue
git push origin main

# æ­¥éª¤ 8: åˆ é™¤ hotfix åˆ†æ”¯ï¼ˆä»»åŠ¡å®Œæˆï¼‰
git branch -d hotfix/0.2.1
git push origin --delete hotfix/0.2.1
```

**ä¸ºä»€ä¹ˆå¿…é¡»åˆå¹¶å› mainï¼Ÿ**

å¦‚æœä¸åˆå¹¶ï¼Œmain åˆ†æ”¯ä»ç„¶åŒ…å«æ—§ bugï¼Œä¸‹æ¬¡å‘å¸ƒ v0.3.0 æ—¶ bug ä¼šé‡ç°ã€‚è¿™è¿åäº† Linus çš„"Never break userspace"åŸåˆ™ã€‚

**å¦‚ä½•é€‰æ‹©åˆå¹¶ç­–ç•¥ï¼Ÿ**

**æƒ…å†µAï¼ˆä½¿ç”¨ merge --no-ffï¼‰**ï¼š

- âœ… mainåˆ†æ”¯æœªé‡æ„bugç›¸å…³çš„ä»£ç 
- âœ… ä»£ç ç»“æ„åŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯ç‰ˆæœ¬å·ä¸åŒ
- âœ… mergeèƒ½é¡ºåˆ©è¿›è¡Œï¼Œå†²çªå°‘æˆ–æ— å†²çª
- ä¼˜åŠ¿ï¼šä¿ç•™å®Œæ•´çš„hotfixä¸Šä¸‹æ–‡ï¼ˆcommitå†å²ï¼‰

**æƒ…å†µBï¼ˆä½¿ç”¨ cherry-pickï¼‰**ï¼š

- âš ï¸ mainåˆ†æ”¯å·²é‡æ„bugç›¸å…³æ¨¡å—ï¼ˆä¸ºäº†v0.3.0æ–°åŠŸèƒ½ï¼‰
- âš ï¸ ä»£ç ç»“æ„å®Œå…¨æ”¹å˜ï¼Œç›´æ¥mergeä¼šäº§ç”Ÿå·¨å¤§å†²çª
- âš ï¸ mergeåéœ€è¦å¤§é‡æ‰‹åŠ¨è§£å†³å†²çª
- ä¼˜åŠ¿ï¼šåªæå–bugä¿®å¤é€»è¾‘ï¼Œé¿å…mergeå†²çªå™©æ¢¦

**åˆ¤æ–­æ–¹æ³•**ï¼š

```bash
# å…ˆå°è¯•mergeï¼ˆåœ¨æœ¬åœ°æµ‹è¯•åˆ†æ”¯ï¼‰
git checkout -b test-merge main
git merge hotfix/0.2.1 --no-ff

# å¦‚æœå†²çªæ–‡ä»¶å°‘ï¼ˆ<3ä¸ªï¼‰ä¸”å®¹æ˜“è§£å†³ â†’ ä½¿ç”¨æƒ…å†µA
# å¦‚æœå†²çªæ–‡ä»¶å¤šï¼ˆ>5ä¸ªï¼‰æˆ–ä»£ç ç»“æ„å®Œå…¨ä¸åŒ â†’ ä½¿ç”¨æƒ…å†µB

# æ¸…ç†æµ‹è¯•åˆ†æ”¯
git checkout main
git branch -D test-merge
```

**çœŸå®æ¡ˆä¾‹**ï¼š

- v0.2.0 çš„ `auth.ts` æœ‰ bugï¼ˆ100è¡Œï¼‰
- main ä¸ºäº† v0.3.0 é‡æ„ä¸º `auth/` ç›®å½•ï¼ˆ5ä¸ªæ–‡ä»¶ï¼Œ500è¡Œï¼‰
- ç›´æ¥ mergeï¼šå†²çªæ¶‰åŠæ•´ä¸ªè®¤è¯æ¨¡å—
- cherry-pickï¼šåªæå–1ä¸ªcommitçš„bugä¿®å¤é€»è¾‘ï¼ˆ5è¡Œæ”¹åŠ¨ï¼‰

**Hotfix vs Feature çš„åŒºåˆ«ï¼š**

| ç‰¹æ€§         | Feature Branch             | Hotfix Branch              |
| ------------ | -------------------------- | -------------------------- |
| **èµ·ç‚¹**     | ä» `main` åˆ›å»º             | ä» `release tag` åˆ›å»º      |
| **ç›®æ ‡**     | æ·»åŠ æ–°åŠŸèƒ½                 | ä¿®å¤ç”Ÿäº§ç¯å¢ƒ bug           |
| **ç”Ÿå‘½å‘¨æœŸ** | 2-3 å¤©                     | æ•°å°æ—¶ï¼ˆç´§æ€¥ï¼‰             |
| **ç‰ˆæœ¬å·**   | ä¸‹ä¸€ä¸ª minor ç‰ˆæœ¬ (v0.3.0) | ä¸‹ä¸€ä¸ª patch ç‰ˆæœ¬ (v0.2.1) |
| **åˆå¹¶æ–¹å‘** | `feature` â†’ `main`         | `hotfix` â†’ `main` + å‘å¸ƒ   |

**GitHub Milestone å…³è”ï¼š**

Hotfix é€šå¸¸ä¸å…³è” Milestoneï¼ˆå› ä¸ºæ˜¯ç´§æ€¥ä¿®å¤ï¼‰ï¼Œä½†åº”è¯¥ï¼š

- åˆ›å»º Issue è®°å½• bug å’Œä¿®å¤è¿‡ç¨‹ï¼ˆä¾¿äºè¿½æº¯ï¼‰
- ä½¿ç”¨ `Closes #issue-number` å…³è”åˆ° bug æŠ¥å‘Š

---

### 5. Git Hooks é…ç½®æ–¹æ¡ˆ

æä¾›ä¸‰ç§æ–¹æ¡ˆï¼Œæ ¹æ®é¡¹ç›®ç‰¹ç‚¹é€‰æ‹©ï¼š

#### æ–¹æ¡ˆ 1: åŸç”Ÿ Git Hooksï¼ˆé›¶ä¾èµ–ï¼Œé«˜æ€§èƒ½ï¼‰

**é€‚ç”¨åœºæ™¯ï¼š**

- å°å‹å›¢é˜Ÿæˆ–ä¸ªäººé¡¹ç›®
- è¿½æ±‚æœ€å°ä¾èµ–å’Œç®€æ´é…ç½®
- å¯¹æ€§èƒ½æœ‰è¦æ±‚çš„é¡¹ç›®

**åˆ›å»º `.git/hooks/pre-commit` æ–‡ä»¶ï¼š**

```bash
#!/usr/bin/env sh
# Git pre-commit hook - è‡ªåŠ¨æ ¼å¼åŒ–æš‚å­˜çš„æ–‡ä»¶

echo "ğŸ” æ­£åœ¨æ£€æŸ¥æš‚å­˜æ–‡ä»¶..."

# è·å–æ‰€æœ‰æš‚å­˜çš„æ–‡ä»¶ï¼ˆåªåŒ…æ‹¬æ·»åŠ å’Œä¿®æ”¹çš„æ–‡ä»¶ï¼‰
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(js|ts|jsx|tsx|vue|json|md|yaml|yml|css|scss|less|html|py|go|rs|java|kt)$')

if [ -z "$STAGED_FILES" ]; then
    echo "æ²¡æœ‰éœ€è¦æ ¼å¼åŒ–çš„æ–‡ä»¶"
    exit 0
fi

echo "æ­£åœ¨æ ¼å¼åŒ–ä»¥ä¸‹æ–‡ä»¶:"
echo "$STAGED_FILES"

# å°†æ–‡ä»¶åˆ—è¡¨è½¬æ¢ä¸ºæ•°ç»„å¹¶é€ä¸ªæ ¼å¼åŒ–
echo "$STAGED_FILES" | while IFS= read -r file; do
    if [ -f "$file" ]; then
        # æ ¹æ®åŒ…ç®¡ç†å™¨é€‰æ‹©è¿è¡Œæ–¹å¼
        if command -v bunx &> /dev/null; then
            bunx prettier --write "$file"
        elif command -v pnpm &> /dev/null; then
            pnpm exec prettier --write "$file"
        else
            npx prettier --write "$file"
        fi
        git add "$file"
    fi
done

echo "âœ… ä»£ç æ ¼å¼åŒ–å®Œæˆ"
exit 0
```

**èµ‹äºˆæ‰§è¡Œæƒé™ï¼š**

```bash
chmod +x .git/hooks/pre-commit
```

**å¤šè¯­è¨€é¡¹ç›®æ”¯æŒï¼š**

```bash
#!/usr/bin/env sh

echo "ğŸ” æ­£åœ¨æ ¼å¼åŒ–ä»£ç ..."

STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM)

# JavaScript/TypeScript æ–‡ä»¶ä½¿ç”¨ Prettier
JS_FILES=$(echo "$STAGED_FILES" | grep -E '\.(js|ts|jsx|tsx|vue|json|md)$')
if [ -n "$JS_FILES" ]; then
    echo "ğŸ“ æ ¼å¼åŒ– JS/TS æ–‡ä»¶..."
    echo "$JS_FILES" | xargs bunx prettier --write
    echo "$JS_FILES" | xargs git add
fi

# Python æ–‡ä»¶ä½¿ç”¨ black
PY_FILES=$(echo "$STAGED_FILES" | grep -E '\.py$')
if [ -n "$PY_FILES" ]; then
    echo "ğŸ æ ¼å¼åŒ– Python æ–‡ä»¶..."
    echo "$PY_FILES" | xargs black
    echo "$PY_FILES" | xargs git add
fi

# Rust æ–‡ä»¶ä½¿ç”¨ rustfmt
RS_FILES=$(echo "$STAGED_FILES" | grep -E '\.rs$')
if [ -n "$RS_FILES" ]; then
    echo "ğŸ¦€ æ ¼å¼åŒ– Rust æ–‡ä»¶..."
    echo "$RS_FILES" | xargs rustfmt
    echo "$RS_FILES" | xargs git add
fi

# Go æ–‡ä»¶ä½¿ç”¨ gofmt
GO_FILES=$(echo "$STAGED_FILES" | grep -E '\.go$')
if [ -n "$GO_FILES" ]; then
    echo "ğŸ¹ æ ¼å¼åŒ– Go æ–‡ä»¶..."
    echo "$GO_FILES" | xargs gofmt -w
    echo "$GO_FILES" | xargs git add
fi

echo "âœ… æ ¼å¼åŒ–å®Œæˆ"
exit 0
```

**å›¢é˜Ÿåä½œæ–¹æ¡ˆï¼š**

æ–¹æ¡ˆ A - æ–‡æ¡£è¯´æ˜ï¼ˆåœ¨ README.md ä¸­ï¼‰ï¼š

````markdown
## Git Hooks è®¾ç½®

æœ¬é¡¹ç›®ä½¿ç”¨åŸç”Ÿ Git Hooks å®ç°è‡ªåŠ¨æ ¼å¼åŒ–ã€‚å…‹éš†é¡¹ç›®åï¼Œè¯·è¿è¡Œï¼š

\```bash
cp scripts/pre-commit .git/hooks/pre-commit
chmod +x .git/hooks/pre-commit
\```
````

æ–¹æ¡ˆ B - è‡ªåŠ¨åŒ–è®¾ç½®è„šæœ¬ï¼ˆæ¨èï¼‰ï¼š

åˆ›å»º `scripts/setup-hooks.sh`ï¼š

```bash
#!/bin/bash
echo "ğŸ”§ è®¾ç½® Git Hooks..."
cp scripts/hooks/pre-commit .git/hooks/pre-commit
chmod +x .git/hooks/pre-commit
echo "âœ… Git Hooks è®¾ç½®å®Œæˆ"
```

åœ¨ package.json ä¸­æ·»åŠ ï¼š

```json
{
  "scripts": {
    "postinstall": "./scripts/setup-hooks.sh"
  }
}
```

æ–¹æ¡ˆ C - Git 2.9+ core.hooksPathï¼š

```bash
# å°† hooks æ”¾åœ¨ç‰ˆæœ¬æ§åˆ¶ä¸­
mkdir .githooks
mv .git/hooks/pre-commit .githooks/

# è®¾ç½® hooks è·¯å¾„
git config core.hooksPath .githooks
```

å›¢é˜Ÿæˆå‘˜å…‹éš†ååªéœ€è¿è¡Œä¸€æ¬¡ï¼š

```bash
git config core.hooksPath .githooks
```

**æ€§èƒ½ï¼š** çº¦ 0.5 ç§’ï¼ˆæœ€å¿«ï¼‰

---

#### æ–¹æ¡ˆ 2: Husky + Lint-stagedï¼ˆNode.js ç”Ÿæ€æ ‡å‡†ï¼‰

**é€‚ç”¨åœºæ™¯ï¼š**

- Node.js ç”Ÿæ€çš„å¤§å‹å›¢é˜Ÿé¡¹ç›®
- éœ€è¦ä¸ npm/pnpm æ·±åº¦é›†æˆ
- å›¢é˜Ÿæˆå‘˜å¯¹ Git Hooks ä¸ç†Ÿæ‚‰

**å®‰è£…ï¼š**

```bash
pnpm add -D husky lint-staged
```

**é…ç½® package.jsonï¼š**

```json
{
  "scripts": {
    "prepare": "husky install"
  },
  "lint-staged": {
    "*.{js,ts,jsx,tsx,json,md}": ["prettier --write", "eslint --fix"]
  }
}
```

**åˆå§‹åŒ– Huskyï¼š**

```bash
pnpm exec husky install
pnpm exec husky add .husky/pre-commit "pnpm exec lint-staged"
```

**æ€§èƒ½ï¼š** çº¦ 2.3 ç§’

---

#### æ–¹æ¡ˆ 3: pre-commit æ¡†æ¶ï¼ˆè·¨è¯­è¨€æ¨èï¼‰

**é€‚ç”¨åœºæ™¯ï¼š**

- è·¨è¯­è¨€é¡¹ç›®ï¼ˆPython/Go/Rust/Node.js æ··åˆï¼‰
- éœ€è¦å¤šä¸ª hooks ä½†ä¸æƒ³å†™ shell è„šæœ¬
- å¸Œæœ›ä½¿ç”¨ç¤¾åŒºé¢„å®šä¹‰çš„ hooks

**æ ¸å¿ƒä¼˜åŠ¿ï¼š**

- âœ… è·¨è¯­è¨€æ”¯æŒ - ä¸€ä¸ªå·¥å…·ç®¡ç†æ‰€æœ‰è¯­è¨€çš„ hooks
- âœ… é…ç½®æ–‡ä»¶é©±åŠ¨ - `.pre-commit-config.yaml` å¯æäº¤åˆ°ä»“åº“
- âœ… è‡ªåŠ¨å®‰è£… - `pre-commit install` ä¸€æ¬¡é…ç½®ï¼Œå›¢é˜Ÿå…±äº«
- âœ… æ€§èƒ½ä¼˜åŒ– - è‡ªåŠ¨ç¼“å­˜ä¾èµ–ï¼Œåªæ ¼å¼åŒ– changed files
- âœ… ä¸°å¯Œçš„é¢„å®šä¹‰ hooks - ç¤¾åŒºç»´æŠ¤çš„å¤§é‡ç°æˆ hooks

**å®‰è£…ï¼š**

```bash
# macOS/Linux
brew install pre-commit

# æˆ–ä½¿ç”¨ pip
pip install pre-commit

# æˆ–ä½¿ç”¨ pipxï¼ˆæ¨èï¼Œéš”ç¦»ç¯å¢ƒï¼‰
pipx install pre-commit
```

**åˆ›å»ºé…ç½®æ–‡ä»¶ `.pre-commit-config.yaml`ï¼š**

```yaml
# è·¨è¯­è¨€é€šç”¨é…ç½®ç¤ºä¾‹
repos:
  # é€šç”¨æ£€æŸ¥ï¼ˆæ‰€æœ‰é¡¹ç›®æ¨èï¼‰
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace # ç§»é™¤è¡Œå°¾ç©ºæ ¼
      - id: end-of-file-fixer # ç¡®ä¿æ–‡ä»¶ä»¥æ¢è¡Œç¬¦ç»“å°¾
      - id: check-yaml # æ£€æŸ¥YAMLè¯­æ³•
      - id: check-json # æ£€æŸ¥JSONè¯­æ³•
      - id: check-added-large-files # é˜²æ­¢æäº¤å¤§æ–‡ä»¶
        args: ['--maxkb=500']
      - id: check-merge-conflict # æ£€æŸ¥åˆå¹¶å†²çªæ ‡è®°

  # JavaScript/TypeScript é¡¹ç›®
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v3.1.0
    hooks:
      - id: prettier
        types_or: [javascript, jsx, ts, tsx, json, yaml, markdown]

  # Python é¡¹ç›®
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.1.9
    hooks:
      - id: ruff
        args: [--fix]
      - id: ruff-format

  # Rust é¡¹ç›®
  - repo: https://github.com/doublify/pre-commit-rust
    rev: v1.0
    hooks:
      - id: fmt
      - id: clippy

  # Go é¡¹ç›®
  - repo: https://github.com/dnephin/pre-commit-golang
    rev: v0.5.1
    hooks:
      - id: go-fmt
      - id: go-lint
```

**æ¿€æ´» pre-commitï¼š**

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼ˆåªéœ€ä¸€æ¬¡ï¼‰
pre-commit install

# å›¢é˜Ÿæˆå‘˜åŠ å…¥é¡¹ç›®åï¼š
git clone <é¡¹ç›®>
pre-commit install  # è‡ªåŠ¨è¯»å– .pre-commit-config.yaml
```

**å®é™…ä½¿ç”¨ç¤ºä¾‹ï¼ˆTypeScript + Python æ··åˆé¡¹ç›®ï¼‰ï¼š**

```yaml
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer

  # TypeScript
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v3.1.0
    hooks:
      - id: prettier
        files: \.(js|ts|jsx|tsx|json|yaml|md)$

  # Python
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.1.9
    hooks:
      - id: ruff
        args: [--fix]
```

**å¸¸ç”¨å‘½ä»¤ï¼š**

```bash
# æ‰‹åŠ¨è¿è¡Œæ‰€æœ‰hooksï¼ˆåœ¨æ‰€æœ‰æ–‡ä»¶ä¸Šï¼‰
pre-commit run --all-files

# åªè¿è¡Œç‰¹å®šhook
pre-commit run prettier --all-files

# æ›´æ–°æ‰€æœ‰hooksåˆ°æœ€æ–°ç‰ˆæœ¬
pre-commit autoupdate

# è·³è¿‡hooksï¼ˆä¸´æ—¶ï¼‰
SKIP=prettier git commit -m "message"
```

**CI é›†æˆï¼š**

```yaml
# .github/workflows/ci.yml
name: CI

on: [push, pull_request]

jobs:
  pre-commit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
      - name: Run pre-commit
        uses: pre-commit/action@v3.0.0
```

**æ€§èƒ½ï¼š** çº¦ 0.8 ç§’

---

### æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“

| ç‰¹æ€§           | åŸç”Ÿ Git Hooks   | Husky + Lint-staged | pre-commit æ¡†æ¶              |
| -------------- | ---------------- | ------------------- | ---------------------------- |
| **ä¾èµ–**       | æ—                | Node.js å¿…éœ€        | Pythonï¼ˆé€šå¸¸å·²å®‰è£…ï¼‰         |
| **æ€§èƒ½**       | æœ€å¿«ï¼ˆ0.5ç§’ï¼‰    | æ…¢ï¼ˆ2.3ç§’ï¼‰         | å¿«ï¼ˆ0.8ç§’ï¼‰                  |
| **è·¨è¯­è¨€**     | éœ€æ‰‹å†™è„šæœ¬       | ä»… Node.js ç”Ÿæ€     | åŸç”Ÿæ”¯æŒæ‰€æœ‰è¯­è¨€             |
| **å›¢é˜Ÿå…±äº«**   | éœ€æ‰‹åŠ¨å¤åˆ¶æˆ–é…ç½® | package.json è‡ªåŠ¨   | .pre-commit-config.yaml è‡ªåŠ¨ |
| **ç¤¾åŒº hooks** | éœ€è‡ªå·±å†™         | npm ç”Ÿæ€            | è·¨è¯­è¨€ hooks åº“              |
| **å­¦ä¹ æ›²çº¿**   | éœ€æ‡‚ shell       | ç®€å•                | ç®€å•                         |
| **æ¨èåœºæ™¯**   | å°å›¢é˜Ÿ/è¿½æ±‚æ€§èƒ½  | Node.js å¤§å‹å›¢é˜Ÿ    | è·¨è¯­è¨€é¡¹ç›®                   |

---

## Day 0 å¿«é€Ÿå¯åŠ¨æ¸…å•

### åœºæ™¯ A: ä»é›¶å¼€å§‹ï¼ˆ2-4 å°æ—¶ï¼‰

**ç¬¬ä¸€æ­¥ï¼šäº”ç»´åº¦è®¿è°ˆï¼ˆ2-4å°æ—¶ï¼‰**

- [ ] ç»´åº¦1ï¼šé¡¹ç›®å®šä¹‰ä¸æŠ€æœ¯æ ˆ
- [ ] ç»´åº¦2ï¼šæ¶æ„è®¾è®¡
- [ ] ç»´åº¦3ï¼šè´¨é‡ä¿éšœ
- [ ] ç»´åº¦4ï¼šæ„å»ºå‘å¸ƒ
- [ ] ç»´åº¦5ï¼šæ–‡æ¡£è§„èŒƒ

**ç¬¬äºŒæ­¥ï¼šç”Ÿæˆ ADRï¼ˆ30åˆ†é’Ÿï¼‰**

- [ ] ADR-001: æŠ€æœ¯æ ˆé€‰å‹
- [ ] ADR-002: æ¶æ„è¾¹ç•Œ
- [ ] ADR-003: è´¨é‡æ ‡å‡†

**ç¬¬ä¸‰æ­¥ï¼šåˆå§‹åŒ–é¡¹ç›®ï¼ˆ30åˆ†é’Ÿï¼‰**

- [ ] è¿è¡Œé¡¹ç›®æ¨¡æ¿ç”Ÿæˆå™¨
- [ ] è¿è¡Œé…ç½®è‡ªåŠ¨æ£€æŸ¥ï¼š`npm run check-config`
- [ ] è®¾ç½® Git Hooksï¼ˆé€‰æ‹©æ–¹æ¡ˆ1/2/3ï¼‰
- [ ] é…ç½® CI/CD

**ç¬¬å››æ­¥ï¼šåˆ›å»ºç‰ˆæœ¬è§„åˆ’ï¼ˆ15åˆ†é’Ÿï¼‰**

- [ ] åˆ›å»º GitHub Milestone v0.1
- [ ] å®šä¹‰ç‰ˆæœ¬ç›®æ ‡å’Œå®Œæˆæ ‡å‡†

**ç¬¬äº”æ­¥ï¼šç¬¬ä¸€æ¬¡æäº¤ï¼ˆ5åˆ†é’Ÿï¼‰**

```bash
git add .
git commit -m "chore: initial project structure with ADR"
git push
```

**æ€»è€—æ—¶ï¼šçº¦ 3-4 å°æ—¶**

---

### åœºæ™¯ B: å·²æœ‰åˆå§‹èµ„æ–™ï¼ˆ1.5-2 å°æ—¶ï¼‰

**ç¬¬ä¸€æ­¥ï¼šèµ„æ–™æ”¶é›†ï¼ˆ15åˆ†é’Ÿï¼‰**

- [ ] æ”¶é›†ç°æœ‰æ–‡æ¡£ï¼ˆPRDã€æŠ€æœ¯è°ƒç ”ã€æ¶æ„å›¾ï¼‰
- [ ] æ˜ å°„åˆ°äº”ç»´åº¦æ¡†æ¶

**ç¬¬äºŒæ­¥ï¼šè¡¥å…¨è®¿è°ˆï¼ˆ1å°æ—¶ï¼‰**

- [ ] å¿«é€Ÿç¡®è®¤å·²æœ‰ä¿¡æ¯
- [ ] æ·±å…¥è®¿è°ˆç¼ºå¤±éƒ¨åˆ†

**ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆ ADRï¼ˆ15åˆ†é’Ÿï¼‰**

- [ ] æ ‡å‡†åŒ–ç°æœ‰æŠ€æœ¯å†³ç­–ä¸º ADR æ ¼å¼

**ç¬¬å››æ­¥ï¼šåˆå§‹åŒ–é¡¹ç›®ï¼ˆ15åˆ†é’Ÿï¼‰**

- [ ] é…ç½®è‡ªåŠ¨æ£€æŸ¥
- [ ] åˆ›å»º GitHub Milestone v0.1

**ç¬¬äº”æ­¥ï¼šç¬¬ä¸€æ¬¡æäº¤ï¼ˆ5åˆ†é’Ÿï¼‰**

```bash
git add .
git commit -m "chore: initial project structure with ADR"
git push
```

**æ€»è€—æ—¶ï¼šçº¦ 2 å°æ—¶**

---

### åœºæ™¯ C: å·²æœ‰é¡¹ç›®æ¥å…¥æµç¨‹ï¼ˆ2-3 å°æ—¶ï¼‰

**ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨ Repomix åˆ†æé¡¹ç›®ï¼ˆ30åˆ†é’Ÿï¼‰**

ä½¿ç”¨ Repomix MCP å·¥å…·åˆ†æç°æœ‰ä»£ç åº“ï¼š

```typescript
// åœ¨ Claude Code ä¸­è°ƒç”¨ MCP å·¥å…·
mcp__repomix__pack_codebase({
  directory: '/path/to/existing/project',
  style: 'xml',
});

// æŸ¥çœ‹ç”Ÿæˆçš„åˆ†ææŠ¥å‘Šï¼ˆè‡ªåŠ¨æ˜¾ç¤ºï¼‰
// åŒ…å«ï¼šæ–‡ä»¶æ ‘ã€ä»£ç ç»Ÿè®¡ã€ä¾èµ–å…³ç³»
```

åˆ†æè¾“å‡ºå†…å®¹ï¼š

- [ ] è¯†åˆ«ä¸»è¦ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶ï¼ˆä» package.json/requirements.txt/Cargo.tomlï¼‰
- [ ] è¯„ä¼°é¡¹ç›®è§„æ¨¡ï¼ˆä»£ç è¡Œæ•°ã€æ–‡ä»¶æ•°é‡ï¼‰
- [ ] åˆ†æç›®å½•ç»“æ„ï¼ˆå‰ç«¯/åç«¯/å…¨æ ˆï¼‰
- [ ] æ£€æŸ¥ç°æœ‰é…ç½®ï¼ˆCI/Git Hooks/æµ‹è¯•ï¼‰

**ç¬¬äºŒæ­¥ï¼šç”Ÿæˆ ADR æ–‡æ¡£ï¼ˆ30åˆ†é’Ÿï¼‰**

åŸºäºä»£ç åˆ†æç»“æœï¼Œç”Ÿæˆç°çŠ¶å‹ ADRï¼š

- [ ] ADR-001: æŠ€æœ¯æ ˆç°çŠ¶

  ```markdown
  # å½“å‰ä½¿ç”¨ï¼šTypeScript + React + Vite

  # æ¨æ–­åŸå› ï¼šç°ä»£åŒ–å¼€å‘ä½“éªŒ + ç±»å‹å®‰å…¨

  # æ”¹è¿›å»ºè®®ï¼šæ·»åŠ æµ‹è¯•æ¡†æ¶
  ```

- [ ] ADR-002: æ¶æ„ç°çŠ¶

  ```markdown
  # å½“å‰ç»“æ„ï¼š[ä» repomix æå–çš„ç›®å½•æ ‘]

  # æ¨¡å—åŒ–ç¨‹åº¦ï¼šä¸­ç­‰

  # æ”¹è¿›å»ºè®®ï¼šæ‹†åˆ†å¤§å‹æ–‡ä»¶ï¼ˆ>300è¡Œï¼‰
  ```

- [ ] ADR-003: è´¨é‡æ”¹è¿›è®¡åˆ’

  ```markdown
  # ç¼ºå¤±é¡¹ï¼šCI/Git Hooks/ä»£ç è§„èŒƒ

  # ä¼˜å…ˆçº§ï¼šP0ï¼ˆCIï¼‰ > P1ï¼ˆHooksï¼‰ > P2ï¼ˆæµ‹è¯•ï¼‰
  ```

**ç¬¬ä¸‰æ­¥ï¼šé…ç½®åŸºç¡€è®¾æ–½ï¼ˆ45åˆ†é’Ÿï¼‰**

æ¸è¿›å¼æ¥å…¥ï¼Œé¿å…ç ´åç°æœ‰ä»£ç ï¼š

- [ ] å®‰è£…ä»£ç æ ¼å¼åŒ–å·¥å…·

  ```bash
  pnpm add -D prettier eslint
  ```

- [ ] é…ç½® Git Hooksï¼ˆåªæ£€æŸ¥æ–°ä»£ç ï¼‰

  ```json
  {
    "lint-staged": {
      "*.{ts,tsx}": ["prettier --write", "eslint --fix"]
    }
  }
  ```

- [ ] é…ç½® GitHub Actions CI
  ```yaml
  # å…ˆè¿è¡Œä½†ä¸é˜»æ­¢åˆå¹¶ï¼ˆé€‚åº”æœŸï¼‰
  # 1ä¸ªæœˆåæ”¹ä¸ºå¼ºåˆ¶æ£€æŸ¥
  ```

**ç¬¬å››æ­¥ï¼šè§„èŒƒåŒ–æ–‡æ¡£ï¼ˆ30åˆ†é’Ÿï¼‰**

- [ ] æ›´æ–° README.mdï¼ˆåŸºäº repomix åˆ†æç»“æœï¼‰
  - æ·»åŠ æŠ€æœ¯æ ˆè¯´æ˜
  - æ·»åŠ é¡¹ç›®ç»“æ„è¯´æ˜
  - æ·»åŠ å¿«é€Ÿå¼€å§‹æŒ‡å—

- [ ] åˆ›å»º CONTRIBUTING.md
  - æ–°çš„å¼€å‘æµç¨‹è¯´æ˜
  - Git Hooks è®¾ç½®æŒ‡å—
  - Commit è§„èŒƒ

- [ ] åˆ›å»º `.github/PULL_REQUEST_TEMPLATE.md`
  - PR æ£€æŸ¥æ¸…å•
  - æµ‹è¯•è¦æ±‚

**ç¬¬äº”æ­¥ï¼šåˆ›å»ºè§„èŒƒåŒ– Milestoneï¼ˆ15åˆ†é’Ÿï¼‰**

åˆ›å»ºç¬¬ä¸€ä¸ª Milestone ç”¨äºè§„èŒƒåŒ–æ”¹é€ ï¼š

```bash
gh milestone create "v1.0.0-è§„èŒƒåŒ–" \
  --description "ç›®æ ‡ï¼š
  1. å»ºç«‹å¼€å‘è§„èŒƒï¼ˆCI + Git Hooksï¼‰
  2. è¡¥å…¨æ–‡æ¡£ï¼ˆADR + READMEï¼‰
  3. æå‡ä»£ç è´¨é‡ï¼ˆæµ‹è¯•è¦†ç›– >30%ï¼‰

  å®Œæˆæ ‡å‡†ï¼š
  - CI é…ç½®å®Œæˆå¹¶é€šè¿‡
  - ADR æ–‡æ¡£è¦†ç›–æ ¸å¿ƒå†³ç­–
  - æ ¸å¿ƒä»£ç æœ‰å•å…ƒæµ‹è¯•" \
  --due-date "2025-02-28"
```

åˆ›å»ºåŸºç¡€ Issueï¼š

```bash
gh issue create --title "é…ç½® Prettier + ESLint" --milestone "v1.0.0-è§„èŒƒåŒ–" --label "p0,infra"
gh issue create --title "é…ç½® GitHub Actions CI" --milestone "v1.0.0-è§„èŒƒåŒ–" --label "p0,infra"
gh issue create --title "ç”Ÿæˆ ADR æ–‡æ¡£" --milestone "v1.0.0-è§„èŒƒåŒ–" --label "p1,docs"
```

**æ€»è€—æ—¶ï¼šçº¦ 2-3 å°æ—¶**

---

## æ ¸å¿ƒæ•°æ®ç»“æ„

```
ADRæ–‡æ¡£ï¼ˆæŠ€æœ¯è¾¹ç•Œï¼ŒDay 0ä¸€æ¬¡æ€§ï¼‰
  â†“
GitHub Milestonesï¼ˆç‰ˆæœ¬è§„åˆ’ï¼Œæ¯ç‰ˆæœ¬ä¸€ä¸ªï¼‰
  â†“
GitHub Issuesï¼ˆå…·ä½“ä»»åŠ¡ï¼Œè‡ªåŠ¨å…³è”ï¼‰
  â†“
Feature Branchesï¼ˆä»£ç éš”ç¦»ï¼‰
  â†“
Commitsï¼ˆæäº¤å†å²ï¼‰
  â†“
Tagsï¼ˆç‰ˆæœ¬é‡Œç¨‹ç¢‘ï¼‰
```

**æ ¸å¿ƒç‰¹ç‚¹ï¼š**

- å•å‘ä¾èµ–ï¼Œæ— å¾ªç¯
- è‡ªåŠ¨åŒæ­¥ï¼Œæ— å†—ä½™
- GitHub åŸç”ŸåŠŸèƒ½ï¼Œé›¶é¢å¤–å·¥å…·

---

## å‚è€ƒæ–‡æ¡£

- [é¡¹ç›®å¼€å‘é»„é‡‘æµç¨‹](../../CLAUDE.md)
- [GitHub Milestone å®˜æ–¹æ–‡æ¡£](https://docs.github.com/en/issues/using-labels-and-milestones-to-track-work/about-milestones)
- [GitHub CLI Milestone å‘½ä»¤](https://cli.github.com/manual/gh_milestone)
- [pre-commit å®˜æ–¹æ–‡æ¡£](https://pre-commit.com/)
