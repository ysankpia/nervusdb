#!/bin/sh
# Git pre-commit hook for Rust project
set -e

echo "ğŸ”§ [pre-commit] Running checks..."

# Format code
echo "ğŸ“ Formatting code..."
cargo fmt --all

# Run clippy
echo "ğŸ” Running clippy..."
if ! cargo clippy --workspace --all-targets -- -W warnings; then
    echo "âŒ Clippy checks failed. Please fix the issues and try again."
    exit 1
fi

# Run quick tests
echo "âš¡ Running quick tests..."
if ! cargo test --lib --workspace --no-fail-fast; then
    echo "âŒ Tests failed. Please fix the failing tests and try again."
    exit 1
fi

# Stage formatted files
git add -u

echo "âœ… Pre-commit checks passed!"
exit 0
