# NervusDB

> åµŒå…¥å¼ä¸‰å…ƒç»„ï¼ˆSPOï¼‰çŸ¥è¯†åº“ï¼ŒæœåŠ¡æœ¬åœ°/è¾¹ç¼˜åœºæ™¯çš„çŸ¥è¯†ç®¡ç†ã€é“¾å¼è”æƒ³ä¸è½»é‡æ¨ç†ã€‚

## ç›®å½•

1. [é¡¹ç›®æ¦‚è§ˆ](#é¡¹ç›®æ¦‚è§ˆ)
2. [ç³»ç»Ÿæ¶æ„æ€»è§ˆ](#ç³»ç»Ÿæ¶æ„æ€»è§ˆ)
3. [æ¶æ„å†³ç­–è®°å½• (ADR)](#æ¶æ„å†³ç­–è®°å½•-adr)
4. [æ ¸å¿ƒç‰¹æ€§çŸ©é˜µ](#æ ¸å¿ƒç‰¹æ€§çŸ©é˜µ)
5. [å®‰è£…ä¸ç¯å¢ƒå‡†å¤‡](#å®‰è£…ä¸ç¯å¢ƒå‡†å¤‡)
6. [å¿«é€Ÿä¸Šæ‰‹](#å¿«é€Ÿä¸Šæ‰‹)
7. [æ•°æ®æ¨¡å‹ä¸ API](#æ•°æ®æ¨¡å‹ä¸-api)
8. [å­˜å‚¨æ ¼å¼ä¸æŒä¹…åŒ–](#å­˜å‚¨æ ¼å¼ä¸æŒä¹…åŒ–)
9. [æŸ¥è¯¢å¼•æ“ä¸å¤šè¯­è¨€æ¥å£](#æŸ¥è¯¢å¼•æ“ä¸å¤šè¯­è¨€æ¥å£)
10. [äº‹åŠ¡ã€å¹¶å‘ä¸å®¹é”™æœºåˆ¶](#äº‹åŠ¡å¹¶å‘ä¸å®¹é”™æœºåˆ¶)
11. [ç´¢å¼•ä½“ç³»ä¸æ€§èƒ½è°ƒä¼˜](#ç´¢å¼•ä½“ç³»ä¸æ€§èƒ½è°ƒä¼˜)
12. [è¿ç»´ä¸æ²»ç†å·¥å…·](#è¿ç»´ä¸æ²»ç†å·¥å…·)
13. [ç›‘æ§ã€è¯Šæ–­ä¸å¯è§‚å¯Ÿæ€§](#ç›‘æ§è¯Šæ–­ä¸å¯è§‚å¯Ÿæ€§)
14. [é›†æˆæ¨¡å¼ä¸å®è·µ](#é›†æˆæ¨¡å¼ä¸å®è·µ)
15. [ç¤ºä¾‹ä¸å­¦ä¹ èµ„æº](#ç¤ºä¾‹ä¸å­¦ä¹ èµ„æº)
16. [å®‰å…¨ã€å¤‡ä»½ä¸åˆè§„](#å®‰å…¨å¤‡ä»½ä¸åˆè§„)
17. [è·¯çº¿å›¾ä¸ç‰ˆæœ¬ç­–ç•¥](#è·¯çº¿å›¾ä¸ç‰ˆæœ¬ç­–ç•¥)
18. [å¸¸è§é—®é¢˜ FAQ](#å¸¸è§é—®é¢˜-faq)
19. [åŸºå‡†æµ‹è¯•ä¸æ€§èƒ½éªŒè¯](#åŸºå‡†æµ‹è¯•ä¸æ€§èƒ½éªŒè¯)
20. [å‚ä¸è´¡çŒ®ä¸æ”¯æŒ](#å‚ä¸è´¡çŒ®ä¸æ”¯æŒ)
21. [è®¸å¯è¯](#è®¸å¯è¯)

---

## é¡¹ç›®æ¦‚è§ˆ

- **å®šä½**ï¼šNervusDB æ˜¯ä¸€ä¸ªå•æœºåµŒå…¥å¼çŸ¥è¯†åº“ï¼Œæ ¸å¿ƒå›´ç»•â€œäº‹å®ä¸‰å…ƒç»„ï¼ˆsubject/predicate/objectï¼‰+ å±æ€§â€å­˜å‚¨å’Œé“¾å¼è”æƒ³æŸ¥è¯¢ã€‚ä»¥ TypeScript/Node.js å®ç°ï¼Œå¼ºè°ƒ _å¯æ¢å¤ã€å¯æ²»ç†ã€å¯æ‰©å±•_ã€‚
- **è¿è¡Œç¯å¢ƒ**ï¼šNode.js â‰¥ 18ï¼ˆæ¨è 20/22ï¼‰ï¼ŒmacOS / Linux / Windows å‡å¯ã€‚ä»“åº“é‡‡ç”¨ ESMï¼Œä»£ç ã€æ³¨é‡Šä¸æ–‡æ¡£å…¨éƒ¨ä¸­æ–‡ã€‚
- **é€‚ç”¨åœºæ™¯**ï¼šä»£ç çŸ¥è¯†å›¾è°±ã€é…ç½®ä¾èµ–å›¾ã€åµŒå…¥å¼ AI è®°å¿†ä½“ã€æ•°æ®è¡€ç¼˜å®¡è®¡ã€DevOps çŸ¥è¯†åº“ã€è½»é‡è¾¹ç¼˜éƒ¨ç½²ã€ç¦»çº¿æ¨ç†/å¬å›ã€‚
- **æŠ€æœ¯ç°çŠ¶**ï¼šä¸»å¹²ç‰ˆæœ¬ v1.1.xï¼›WAL v2ã€å¢é‡/æ•´åº compactionã€é“¾å¼è”æƒ³ã€QueryBuilder/Cypher/GraphQL/Gremlinã€å¤šå±æ€§ç´¢å¼•ã€å…¨æ–‡æ£€ç´¢ã€ç©ºé—´ç´¢å¼•ã€å›¾ç®—æ³•ã€è‡ªåŠ¨åŒ–æ²»ç† CLI å‡å·²ç¨³å®šã€‚
- **æ—¶é—´è®°å¿†**ï¼šè‡ª v0.5.0 èµ·é»˜è®¤å¯ç”¨ Temporal Memoryï¼ˆæ—¶é—´çº¿å­˜å‚¨ + æŠ½å–ç®¡çº¿ï¼‰ï¼Œæ— éœ€é¢å¤–é…ç½®å³å¯è¿½è¸ªä¼šè¯è„‰ç»œã€‚
- **è¿‘æœŸéªŒè¯ï¼ˆ2025-09-28ï¼‰**ï¼š
  - âœ… `pnpm test`ï¼ˆ132 ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œ629 ä¸ªç”¨ä¾‹ï¼š628 é€šè¿‡ / 1 è·³è¿‡ï¼‰
  - âœ… `repomix__pack_codebase` è¾“å‡º ID `fe8ec9a35849d45e`ï¼ˆ440 æ–‡ä»¶ï¼Œ842,228 tokensï¼‰

## ç³»ç»Ÿæ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 åº”ç”¨ / å·¥å…·å±‚                 â”‚
â”‚  - Node.js åº”ç”¨ / CLI / è„šæœ¬ / MCP / VSCode  â”‚
â”‚  - GraphQL / Gremlin / Cypher é€‚é…å±‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ QueryBuilder é“¾å¼æ¥å£
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                æŸ¥è¯¢ä¸æ‰§è¡Œå¼•æ“                 â”‚
â”‚  - é“¾å¼è”æƒ³ç®¡çº¿          - èšåˆ/æµå¼è¿­ä»£å™¨       â”‚
â”‚  - å¤šè¯­è¨€è§£æå™¨          - å›¾ç®—æ³•/å±æ€§è¿‡æ»¤       â”‚
â”‚  - æ’ä»¶ç³»ç»Ÿ (PathfindingPlugin/AggregationPlugin) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ Storage API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å­˜å‚¨å†…æ ¸                    â”‚
â”‚  - å…­åºç´¢å¼• (SPO/SOP/POS/PSO/OSP/OPS)         â”‚
â”‚  - WAL v2 / äº‹åŠ¡æ‰¹æ¬¡ / è¯»å¿«ç…§ (epoch-pin)      â”‚
â”‚  - å±æ€§/å…¨æ–‡/ç©ºé—´ç´¢å¼•æ¨¡å—                     â”‚
â”‚  - çƒ­åº¦ç»Ÿè®¡ã€è¯»è€…æ³¨å†Œã€LSM-Lite æš‚å­˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ fs åº•å±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 æŒä¹…åŒ–æ–‡ä»¶å¸ƒå±€                 â”‚
â”‚  - <db>.nervusdb                              â”‚
â”‚  - <db>.nervusdb.pages/                       â”‚
â”‚  - <db>.nervusdb.wal                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ¶æ„å†³ç­–è®°å½• (ADR)

é¡¹ç›®çš„å…³é”®æŠ€æœ¯å†³ç­–è®°å½•åœ¨ `docs/architecture/` ç›®å½•ä¸‹ï¼Œé‡‡ç”¨ [ADR (Architecture Decision Records)](https://adr.github.io/) æ ‡å‡†æ ¼å¼ï¼š

| ADR                                                          | æ ‡é¢˜           | çŠ¶æ€      | è¯´æ˜                                             |
| ------------------------------------------------------------ | -------------- | --------- | ------------------------------------------------ |
| [ADR-001](docs/architecture/ADR-001-Tech-Stack.md)           | æŠ€æœ¯æ ˆé€‰å‹     | âœ… å·²æ¥å— | TypeScript + Node.js ESM + pnpm çš„é€‰æ‹©ç†ç”±ä¸æƒè¡¡ |
| [ADR-002](docs/architecture/ADR-002-Architecture-Design.md)  | æ¶æ„è®¾è®¡       | âœ… å·²æ¥å— | åˆ†å±‚æ¶æ„ + å…­åºç´¢å¼• + WAL + æ’ä»¶ç³»ç»Ÿçš„è®¾è®¡å†³ç­–   |
| [ADR-003](docs/architecture/ADR-003-Quality-Assurance.md)    | è´¨é‡ä¿éšœæœºåˆ¶   | âœ… å·²æ¥å— | CI/CDã€æµ‹è¯•è¦†ç›–ç‡ã€ä»£ç è§„èŒƒçš„è´¨é‡ä¿éšœä½“ç³»        |
| [ADR-004](docs/architecture/ADR-004-Architecture-Upgrade.md) | æ¶æ„å‡çº§è·¯çº¿å›¾ | ğŸ“‹ æè®®ä¸­ | ä»å†…å­˜ä¸­å¿ƒåˆ°ç£ç›˜ä¸­å¿ƒçš„æŒä¹…åŒ–æ¨¡å‹å‡çº§è®¡åˆ’         |
| [ADR-005](docs/architecture/ADR-005-Code-Organization.md)    | ä»£ç ç»„ç»‡ä¸åˆ†å±‚ | âœ… å·²æ¥å— | å•åŒ… + æ¸…æ™°ç›®å½•ç»“æ„ï¼Œåˆ†ç¦»æ ¸å¿ƒå±‚å’Œæ‰©å±•å±‚          |

**ä¸ºä»€ä¹ˆéœ€è¦ ADRï¼Ÿ**

- âœ… **å¯è¿½æº¯æ€§**ï¼š6ä¸ªæœˆåå›é¡¾æŠ€æœ¯é€‰å‹æ—¶ï¼Œå¯ä»¥äº†è§£å½“æ—¶çš„å®Œæ•´è€ƒé‡
- âœ… **çŸ¥è¯†ä¼ æ‰¿**ï¼šæ–°æˆå‘˜å¯ä»¥å¿«é€Ÿç†è§£"ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡"
- âœ… **é¿å…é‡å¤è®¨è®º**ï¼šå½“æœ‰äººæå‡º"ä¸ºä»€ä¹ˆä¸ç”¨ MongoDB/Rust/å¾®å†…æ ¸æ¶æ„"æ—¶ï¼Œç›´æ¥æŸ¥çœ‹ ADR
- âœ… **å†³ç­–è´¨é‡**ï¼šå¼ºåˆ¶å›¢é˜Ÿè€ƒè™‘å¤šä¸ªé€‰é¡¹ï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰ï¼Œè€Œé"ä¸€æ‹è„‘è¢‹"å†³å®š

### ä»£ç ç»„ç»‡æ¶æ„ï¼ˆADR-005ï¼‰

NervusDB é‡‡ç”¨**å•åŒ… + æ¸…æ™°ç›®å½•ç»“æ„**çš„ç»„ç»‡æ–¹å¼ï¼Œå°†ä»£ç åˆ†ä¸ºä¸¤å±‚ï¼š

```
src/
â”œâ”€â”€ core/                    # ğŸ”§ æ•°æ®åº“å†…æ ¸ï¼ˆå¯¹æ ‡ Rust é¡¹ç›®ï¼‰
â”‚   â”œâ”€â”€ storage/            # ä¸‰å…ƒç»„å­˜å‚¨ã€WALã€å…­åºç´¢å¼•
â”‚   â”œâ”€â”€ query/              # åŸºç¡€æŸ¥è¯¢æ„å»ºå™¨
â”‚   â””â”€â”€ index.ts            # æ ¸å¿ƒå±‚å¯¼å‡º
â”‚
â”œâ”€â”€ extensions/             # ğŸš€ åº”ç”¨å±‚æ‰©å±•ï¼ˆTypeScript ç‹¬æœ‰ï¼‰
â”‚   â”œâ”€â”€ fulltext/          # å…¨æ–‡æ£€ç´¢
â”‚   â”œâ”€â”€ spatial/           # ç©ºé—´ç´¢å¼•
â”‚   â”œâ”€â”€ algorithms/        # å›¾ç®—æ³•
â”‚   â””â”€â”€ query/             # é«˜çº§æŸ¥è¯¢ï¼ˆæ¨¡å¼åŒ¹é…ã€è·¯å¾„æŸ¥æ‰¾ã€èšåˆï¼‰
â”‚
â””â”€â”€ index.ts               # ä¸»å…¥å£ï¼ˆå¯¼å‡º core + extensionsï¼‰
```

**ä½¿ç”¨æ–¹å¼**ï¼š

```typescript
// æ–¹å¼ 1ï¼šä½¿ç”¨å®Œæ•´åŠŸèƒ½ï¼ˆæ¨èï¼‰
import { NervusDB } from 'nervusdb';

// æ–¹å¼ 2ï¼šåªä½¿ç”¨æ ¸å¿ƒåŠŸèƒ½
import { Core } from 'nervusdb';
const { PersistentStore } = Core;

// æ–¹å¼ 3ï¼šåªä½¿ç”¨æ‰©å±•åŠŸèƒ½
import { Extensions } from 'nervusdb';
const { FullTextSearch } = Extensions;

// æ–¹å¼ 4ï¼šæŒ‰éœ€å¯¼å…¥ï¼ˆæ”¯æŒ Tree-shakingï¼‰
import { PersistentStore } from 'nervusdb';
import { FullTextSearch } from 'nervusdb';
```

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ**

- âœ… **æ¸…æ™°åˆ†å±‚**ï¼šä¸€çœ¼çœ‹å‡ºæ ¸å¿ƒ vs æ‰©å±•
- âœ… **æ˜“äºæ‰©å±•**ï¼šæ–°æ‰©å±•ç›´æ¥åŠ åˆ° `extensions/`
- âœ… **å¯¹æ¯”æ¸…æ™°**ï¼š`src/core/` ç›´æ¥å¯¹æ ‡ Rust é¡¹ç›®
- âœ… **æ”¯æŒ Tree-shaking**ï¼šæ‰“åŒ…å·¥å…·è‡ªåŠ¨ç§»é™¤æœªä½¿ç”¨çš„ä»£ç 
- âœ… **é›¶ç ´åæ€§**ï¼šä»ç„¶æ˜¯å•ä¸€ npm åŒ…ï¼Œç”¨æˆ·æ— æ„ŸçŸ¥

è¯¦è§ [ADR-005: ä»£ç ç»„ç»‡ä¸åˆ†å±‚](docs/architecture/ADR-005-Code-Organization.md)

## æ ¸å¿ƒç‰¹æ€§çŸ©é˜µ

| èƒ½åŠ›       | å­æ¨¡å—                                            | è¯´æ˜                                                                        |
| ---------- | ------------------------------------------------- | --------------------------------------------------------------------------- |
| ä¸‰å…ƒç»„å­˜å‚¨ | `src/storage/tripleStore.ts`                      | å•æ–‡ä»¶ä¸»åº“ + å…­åºåˆ†é¡µç´¢å¼•ï¼ŒæŒ‰ä¸»é”®æ’åºåˆ†é¡µ                                   |
| é“¾å¼æŸ¥è¯¢   | `src/query/queryBuilder.ts`                       | æ­£åå‘ followã€anchorã€å±æ€§è¿‡æ»¤ã€Streamingã€èšåˆ                            |
| æ—¶é—´è®°å¿†   | `src/core/storage/temporal/temporalStore.ts`      | é»˜è®¤å¯ç”¨æ—¶é—´çº¿å­˜å‚¨ + æå–ç®¡çº¿ï¼Œæ”¯æŒ `db.memory.timelineBuilder()` ä¸è¿½æº¯    |
| å¤šè¯­è¨€æ¥å£ | `src/query/cypher.ts` / `graphql/*` / `gremlin/*` | Cypherã€GraphQLã€Gremlin ä¸ QueryBuilder å…±ç”¨æ‰§è¡Œç®¡çº¿                       |
| äº‹åŠ¡ä¸ WAL | `src/storage/wal.ts` / `txidRegistry.ts`          | WAL v2ã€æ‰¹æ¬¡æäº¤ã€å´©æºƒæ¢å¤ã€äº‹åŠ¡ ID å¹‚ç­‰                                    |
| çƒ­åº¦ä¸æ²»ç† | `src/storage/hotness.ts` / `src/maintenance/*`    | çƒ­åº¦ç»Ÿè®¡ã€è‡ªåŠ¨å‹å®ã€GCã€é¡µä¿®å¤ã€è¯»è€…å°Šé‡ç­–ç•¥                                |
| å±æ€§ç´¢å¼•   | `src/storage/propertyIndex.ts`                    | èŠ‚ç‚¹/è¾¹å±æ€§å€’æ’ç´¢å¼•ï¼ŒèŒƒå›´/å‰ç¼€/ç²¾ç¡®åŒ¹é…                                     |
| å…¨æ–‡æ£€ç´¢   | `src/fulltext/*`                                  | åˆ†è¯ã€å€’æ’ç´¢å¼•ã€æ‰“åˆ†å™¨ã€æ‰¹å¤„ç†å¯¼å…¥ã€æŸ¥è¯¢ DSL                                |
| ç©ºé—´ç´¢å¼•   | `src/spatial/*`                                   | R-Treeã€å‡ ä½•ç±»å‹ã€èŒƒå›´/ç›¸äº¤/æœ€è¿‘é‚»æŸ¥è¯¢                                      |
| å›¾ç®—æ³•     | `src/algorithms/*`                                | Dijkstraã€A\*ã€åŒå‘ BFSã€ä¸­å¿ƒæ€§ã€ç¤¾åŒºå‘ç°ã€ç›¸ä¼¼åº¦                           |
| æ’ä»¶ç³»ç»Ÿ   | `src/plugins/*`                                   | PathfindingPlugin + AggregationPlugin é»˜è®¤åŠ è½½ï¼›CypherPlugin å¯é€‰å®éªŒæ€§å¯ç”¨ |
| åŸºå‡†æµ‹è¯•   | `benchmarks/*` âš ï¸ `src/benchmark/*` å·²å¼ƒç”¨        | å¤–éƒ¨è„šæœ¬åŒ–åŸºå‡†å¥—ä»¶ï¼Œè¾“å‡ºè¯¦ç»†æŒ‡æ ‡ï¼›CLI ä¿æŒå…¼å®¹ä½†æ¨èç›´æ¥è¿è¡Œè„šæœ¬            |
| CLI å·¥å…·   | `src/cli/*`                                       | statsã€checkã€repairã€compactã€auto-compactã€gcã€hotã€txidsã€dump ç­‰        |

## å®‰è£…ä¸ç¯å¢ƒå‡†å¤‡

### ä¾èµ–

- Node.js 18+ï¼ˆæ¨è 20+ï¼‰
- pnpm 8/9/10ï¼ˆæ¨è 10ï¼‰
- macOS/Linux/Windows å‡é€šè¿‡ CI éªŒè¯

### å®‰è£…æµç¨‹

```bash
pnpm install              # å®‰è£…ä¾èµ–
pnpm build                # TypeScript -> dist/
npm i -g .                # å¯é€‰ï¼šå…¨å±€å®‰è£… CLIï¼ˆç”Ÿæˆ nervusdb å‘½ä»¤ï¼‰
```

### å…¶ä»–é€‰æ‹©

- **åŒ…ç®¡ç†å™¨**ï¼š`npm install nervusdb` æˆ– `yarn add nervusdb`
- **Bun**ï¼š`bun add nervusdb`
- **Docker**ï¼ˆåªè¯»ç¤ºä¾‹ï¼‰ï¼šç¤¾åŒºé•œåƒè§ `docs/æ•™å­¦æ–‡æ¡£/æ•™ç¨‹-08-éƒ¨ç½²ä¸æœ€ä½³å®è·µ.md`
- **repl/è„šæœ¬åŒ–**ï¼š`pnpm dlx tsx scripts/dump-graph.mjs`

> å»ºè®®é…ç½® `PNPM_HOME` å¹¶æ‰§è¡Œ `pnpm setup`ï¼Œç¡®ä¿å…¨å±€å‘½ä»¤å¯ç”¨ã€‚

## å¿«é€Ÿä¸Šæ‰‹

### 1. å‡†å¤‡ç¤ºä¾‹åº“

```bash
nervusdb bench demo.nervusdb 200 lsm   # ç”Ÿæˆ 200 æ¡æ¼”ç¤ºæ•°æ®ï¼Œå¯ç”¨ LSM æš‚å­˜
nervusdb stats demo.nervusdb           # æŸ¥çœ‹åŸºæœ¬ç»Ÿè®¡
```

### 2. Node.js ç¨‹åºè°ƒç”¨

```ts
import { NervusDB } from 'nervusdb';

const db = await NervusDB.open('demo.nervusdb', {
  enableLock: true,
  registerReader: true,
  enablePersistentTxDedupe: true,
});

db.addFact(
  { subject: 'user:alice', predicate: 'FRIEND_OF', object: 'user:bob' },
  {
    subjectProperties: { labels: ['Person'], dept: 'R&D' },
    objectProperties: { labels: ['Person'], dept: 'Ops' },
    edgeProperties: { since: '2024-06-01', strength: 0.82 },
  },
);

const chain = await db
  .find({ subject: 'user:alice', predicate: 'FRIEND_OF' })
  .follow('FRIEND_OF')
  .limit(5)
  .all();

await db.flush();
await db.close();
```

### 3. ç±»å‹å®‰å…¨å°è£…

```ts
import { TypedNervusDB } from '@/typedSynapseDb';

interface PersonNode {
  labels: string[];
  title?: string;
}
interface RelationEdge {
  since: string;
  strength: number;
}

const social = await TypedNervusDB.open<PersonNode, RelationEdge>('social.nervusdb');
const good = await social
  .find({ predicate: 'FRIEND_OF' })
  .where((edge) => edge.edgeProperties?.strength! > 0.75)
  .limit(20)
  .all();
```

### 4. CLI ä½“éªŒ

```bash
nervusdb auto-compact demo.nervusdb \
  --mode=incremental --hot-threshold=1.2 --max-primary=5 --auto-gc
nervusdb txids demo.nervusdb --list=20
nervusdb dump demo.nervusdb SPO 1
```

æ›´å¤šåœºæ™¯è§ [ç¤ºä¾‹ä¸å­¦ä¹ èµ„æº](#ç¤ºä¾‹ä¸å­¦ä¹ èµ„æº)ã€‚

### 5. æ—¶é—´è®°å¿†ï¼ˆé»˜è®¤å¯ç”¨ï¼‰

```ts
import { NervusDB } from 'nervusdb';

const db = await NervusDB.open(':memory:');

await db.memory.ingestMessages(
  [
    { author: 'Alice', text: 'Met Bob at #OpenAI HQ.', timestamp: '2025-05-01T09:00:00Z' },
    { author: 'Bob', text: 'Great catching up, Alice!', timestamp: '2025-05-01T09:05:00Z' },
  ],
  { conversationId: 'conv-1', channel: 'chat' },
);

const store = db.memory.getStore();
const alice = store?.getEntities().find((entity) => entity.canonicalName === 'alice');
const mentions = db.memory.timelineBuilder(alice!.entityId).predicate('mentions').all();

console.log('Alice mentions:', mentions.length);
```

> `db.memory` æ— éœ€æ‰‹å·¥åˆå§‹åŒ–ï¼šæ•°æ®åº“æ–‡ä»¶ä¼šè‡ªåŠ¨ç”Ÿæˆ `<db>.temporal.json` æ¥å­˜å‚¨æ—¶é—´çº¿ï¼Œé€‚ç”¨äºå¯¹è¯è®°å¿†ã€å›æº¯ã€å®ä½“æŠ½å–ç­‰åœºæ™¯ã€‚

## æ•°æ®æ¨¡å‹ä¸ API

### äº‹å®ä¸‰å…ƒç»„

- **ä¸»ä½“ (subject)**ï¼šå®ä½“æˆ–èµ„æºï¼Œå†…éƒ¨æ˜ å°„ä¸º `subjectId`
- **è°“è¯ (predicate)**ï¼šå…³ç³»ç±»å‹ï¼Œå†…éƒ¨æ˜ å°„ä¸º `predicateId`
- **å®¢ä½“ (object)**ï¼šç›®æ ‡å®ä½“æˆ–å€¼ï¼Œå†…éƒ¨æ˜ å°„ä¸º `objectId`
- äº‹å®å†™å…¥ï¼š`addFact({ subject, predicate, object }, { subjectProperties?, objectProperties?, edgeProperties? })`

### å±æ€§ç³»ç»Ÿ

- èŠ‚ç‚¹å±æ€§å­˜å‚¨ï¼š`subjectId` / `objectId` -> JSON æ–‡æ¡£ï¼Œå¸¦ç‰ˆæœ¬å· `__v`
- è¾¹å±æ€§å­˜å‚¨ï¼š`subjectId:predicateId:objectId` -> JSON
- å±æ€§ç´¢å¼•ï¼šæ”¯æŒç²¾ç¡®ã€èŒƒå›´ã€å‰ç¼€ã€é›†åˆåŒ…å«æŸ¥è¯¢ï¼Œè¯¦è§ `docs/ä½¿ç”¨ç¤ºä¾‹/TypeScriptç±»å‹ç³»ç»Ÿä½¿ç”¨æŒ‡å—.md`

### QueryBuilder API

```ts
const res = await db
  .find({ predicate: 'FRIEND_OF' }, { anchor: 'subject' })
  .where((edge) => (edge.edgeProperties?.strength as number) > 0.6)
  .follow('WORKS_AT')
  .followReverse('MANAGED_BY')
  .limit(10)
  .all();
```

- `follow` / `followReverse`
- `anchor`: `'subject' | 'object' | 'both'`
- `where` æ”¯æŒå±æ€§/èŠ‚ç‚¹/è¾¹ä¸Šä¸‹æ–‡
- `limit` / `takeUntil` / `distinct`
- Streamingï¼š`for await (const batch of db.streamFacts(criteria, batchSize)) {}`
- èšåˆï¼š`db.aggregate().match(...).groupBy(...).count(...).execute()`

### æ‰¹æ¬¡ä¸äº‹åŠ¡

- `beginBatch({ txId?, sessionId? })`
- `commitBatch({ durable?: boolean })`
- `abortBatch()`
- `txId` + `sessionId` å®ç°è·¨å‘¨æœŸå¹‚ç­‰å»é‡ï¼ˆé‡æ”¾æ—¶è·³è¿‡é‡å¤æäº¤ï¼‰

æ›´å¤š API å®šä¹‰è§ `src/types/openOptions.ts` ä¸ `docs/æ•™å­¦æ–‡æ¡£/æ•™ç¨‹-02-æ•°æ®æ¨¡å‹ä¸åŸºç¡€CRUD.md`ã€‚

## å­˜å‚¨æ ¼å¼ä¸æŒä¹…åŒ–

```
brain.nervusdb               # ä¸»æ•°æ®æ–‡ä»¶
  â”œâ”€ 64B Header (é­”æ•° SYNAPSEDB, version=2)
  â”œâ”€ dictionary section       # å­—ç¬¦ä¸² <-> ID æ˜ å°„
  â”œâ”€ triples section          # ä¸»ä½“/è°“è¯/å®¢ä½“æŒ‰ä¸»é”®æ’åº
  â”œâ”€ indexes (staging)        # LSM-Lite æš‚å­˜æ®µï¼ˆå¯é€‰ï¼‰
  â””â”€ properties section       # èŠ‚ç‚¹/è¾¹å±æ€§ JSON

brain.nervusdb.pages/        # åˆ†é¡µç´¢å¼•ç›®å½•
  â”œâ”€ SPO.idxpage / SOP.idxpage / ...      # å„é¡ºåºé¡µæ–‡ä»¶
  â”œâ”€ index-manifest.json                  # é¡µæ˜ å°„ã€epochã€tombstonesã€orphans
  â”œâ”€ hotness.json                         # primary çƒ­åº¦è®¡æ•° + åŠè¡°
  â”œâ”€ readers.json                         # æ´»è·ƒè¯»è€…ä¿¡æ¯
  â””â”€ txids.json                           # å¹‚ç­‰äº‹åŠ¡æ³¨å†Œè¡¨ï¼ˆå¯é€‰ï¼‰

brain.nervusdb.wal           # WAL v2ï¼ˆè¿½åŠ å†™ï¼‰
```

ç‰¹æ€§è¯´æ˜ï¼š

- **WAL**ï¼šè®°å½• add/delete/property/txIdï¼›å´©æºƒæ¢å¤æ—¶é‡æ”¾å¹¶åœ¨ safe offset æˆªæ–­ã€‚
- **Manifest åŸå­æ›´æ–°**ï¼šå…ˆå†™ `*.tmp` + fsyncï¼Œå†åŸå­ renameï¼Œé¿å…è„æ–‡ä»¶ã€‚
- **çƒ­åº¦ç»Ÿè®¡**ï¼šæŒ‰è®¿é—®/å†™å…¥è‡ªè¡°å‡ï¼Œé©±åŠ¨è‡ªåŠ¨å‹å®ã€‚
- **è¯»è€…æ³¨å†Œ**ï¼šæ²»ç†æ—¶æ£€æµ‹æ´»è·ƒå¿«ç…§ï¼Œè‡ªåŠ¨è·³è¿‡æœ‰è¯»è€…çš„ä¸»é”®ã€‚

è¯¦ç»†æ–‡ä»¶ç»“æ„è§ `docs/æ•™å­¦æ–‡æ¡£/æ•™ç¨‹-07-å­˜å‚¨æ ¼å¼ä¸æŒä¹…åŒ–.md`ã€‚

## æŸ¥è¯¢å¼•æ“ä¸å¤šè¯­è¨€æ¥å£

### QueryBuilder

- èµ·ç‚¹ï¼šä»»æ„ subject/predicate/object ç»„åˆ
- å‰æ²¿å»é‡ï¼šåŸºäº `subjectId:predicateId:objectId`
- æ”¯æŒ streaming è¾“å‡ºã€æ‰¹é‡èšåˆã€å±æ€§ä¸‹æ¨
- `withSnapshot(fn)` åœ¨å›è°ƒæœŸé—´å›ºå®š manifest epoch

### Cypher

```cypher
MATCH (p:Person)-[r:FRIEND_OF*1..3]->(q)
WHERE r.weight > 0.6 AND q.labels CONTAINS 'Engineer'
RETURN q LIMIT 20;
```

- è¯­æ³•å­é›†è¯¦è§ `docs/ä½¿ç”¨ç¤ºä¾‹/Cypherè¯­æ³•å‚è€ƒ.md`
- å®ç°ï¼š`src/query/cypher.ts`

### GraphQL

```graphql
query Friends($id: ID!) {
  synapse {
    find(subject: $id, predicate: "FRIEND_OF") {
      subject
      object
      edgeProperties
    }
  }
}
```

- å‚é˜… `docs/ä½¿ç”¨ç¤ºä¾‹/graphql_usage.md`

### Gremlin

```javascript
g.V('user:alice').repeat(out('FRIEND_OF')).times(2).values('dept');
```

- å‚é˜… `docs/ä½¿ç”¨ç¤ºä¾‹/gremlin_usage.md`

### å›¾ç®—æ³•

- Dijkstra / A\*ï¼šæœ€çŸ­è·¯å¾„ã€æƒé‡å­—æ®µæ”¯æŒ
- åŒå‘ BFSï¼šå¿«é€Ÿæœ€çŸ­è·³æ•°
- ç¤¾åŒºå‘ç° (Louvain) & ä¸­å¿ƒæ€§ (PageRank/Betweenness)
- ç›¸ä¼¼åº¦ï¼šJaccardã€ä½™å¼¦
- å…¥å£æ–‡ä»¶ï¼š`src/algorithms/*`ï¼Œç¤ºä¾‹è§ `docs/ä½¿ç”¨ç¤ºä¾‹/å›¾ç®—æ³•åº“ä½¿ç”¨æŒ‡å—.md`

### å…¨æ–‡ä¸ç©ºé—´

- å…¨æ–‡ï¼šè‡ªå¸¦åˆ†è¯ã€å€’æ’ç´¢å¼•ã€æ‰¹å¤„ç†å¯¼å…¥ä¸æ‰“åˆ†å™¨ï¼Œè§ `docs/ä½¿ç”¨ç¤ºä¾‹/å…¨æ–‡æœç´¢ä½¿ç”¨æŒ‡å—.md`
- ç©ºé—´ï¼šR-Tree + å‡ ä½•ç±»å‹ï¼Œæ”¯æŒèŒƒå›´ã€ç›¸äº¤ã€æœ€è¿‘é‚»ï¼Œè§ `docs/ä½¿ç”¨ç¤ºä¾‹/ç©ºé—´å‡ ä½•è®¡ç®—æŒ‡å—.md`

## äº‹åŠ¡å¹¶å‘ä¸å®¹é”™æœºåˆ¶

- **WAL v2**ï¼š`BEGIN/COMMIT/ABORT`ï¼Œå´©æºƒåé‡æ”¾åˆ° safeOffset
- **æ‰¹æ¬¡**ï¼š`beginBatch` / `commitBatch` / `abortBatch`ï¼›æ”¯æŒ durable commit
- **äº‹åŠ¡ ID å¹‚ç­‰**ï¼šé‡å¤ commit è‡ªåŠ¨è·³è¿‡ï¼›`txids.json` è®°å¿†å†å² ID
- **è¯»å¿«ç…§ä¸€è‡´æ€§**ï¼š
  - `withSnapshot(fn)`ï¼šæ‰‹åŠ¨å¿«ç…§
  - QueryBuilder åœ¨é“¾è·¯æ‰§è¡ŒæœŸé—´è‡ªåŠ¨ epoch-pin
- **å†™é”**ï¼š`enableLock` å®ç°è¿›ç¨‹çº§ç‹¬å å†™
- **è¯»è€…æ³¨å†Œ**ï¼š`registerReader: true` é»˜è®¤å¼€å¯ï¼›ç»´æŠ¤ä»»åŠ¡å°Šé‡è¯»è€…ï¼Œé¿å…ç ´åæ´»è·ƒå¿«ç…§
- **å´©æºƒæ¢å¤æµç¨‹**ï¼š
  1. æ‰“å¼€æ•°æ®åº“
  2. è¯»å– WAL å¹¶é‡æ”¾
  3. åˆå¹¶å¹‚ç­‰äº‹åŠ¡
  4. å¦‚ manifest å¼‚å¸¸ï¼Œæ‰§è¡Œ `nervusdb check --strict`

æ›´å¤šç»†èŠ‚è§ `docs/æ•™å­¦æ–‡æ¡£/æ•™ç¨‹-04-äº‹åŠ¡-WAL-å¹‚ç­‰.md`ã€‚

## ç´¢å¼•ä½“ç³»ä¸æ€§èƒ½è°ƒä¼˜

### å…­åºç´¢å¼•

- SPO / SOP / POS / PSO / OSP / OPS
- åŸºäºå‰ç¼€ä¼˜å…ˆé€‰æ‹©æœ€ä½³ç´¢å¼•
- é¡µå¤§å°å¯é…ç½®ï¼ˆé»˜è®¤ 1024 å·¦å³ï¼‰

### å±æ€§ç´¢å¼•

- æ”¯æŒ `=`ã€`IN`ã€èŒƒå›´ã€å‰ç¼€ã€æ¨¡ç³ŠåŒ¹é…
- å±æ€§å†™å…¥å³åˆ»å¯è§ï¼ˆè¿½åŠ å†™ + å€’æ’æ–‡ä»¶ï¼‰

### çƒ­åº¦é©±åŠ¨å‹å®

- `nervusdb auto-compact`ï¼šåŸºäºçƒ­åº¦ã€é¡µæ•°é‡ã€å¢“ç¢‘æ¯”ä¾‹å†³å®šå¢é‡/æ•´åºç­–ç•¥
- æ”¯æŒ `--include-lsm-segments` è‡ªåŠ¨å¹¶å…¥ LSM æš‚å­˜

### æ€§èƒ½å»ºè®®

- çƒ­ä¸»é”®ï¼šä¼˜å…ˆ incremental æ¨¡å¼
- å†·æ•°æ®ï¼šrewrite + Brotli å‹ç¼©
- WAL è¿‡å¤§ï¼šå®šæœŸ `db.flush()` / `auto-compact` / `gc`
- å±æ€§ç´¢å¼•ï¼šåˆç†è§„åˆ’å­—ç¬¦ä¸²/æ•°å­—ç±»å‹ï¼Œé¿å…è¿‡å¤§ JSON
- æ›´å¤šè°ƒä¼˜æŠ€å·§è§ `docs/ä½¿ç”¨ç¤ºä¾‹/æ€§èƒ½åŸºå‡†æµ‹è¯•æŒ‡å—.md`
- å¿«é€Ÿå›å½’æ£€æµ‹ï¼š`pnpm bench:baseline`ï¼ˆé»˜è®¤ dry-runï¼Œæ— éœ€é¢å¤–å‚æ•°ï¼‰

### æ„å»º Rust åŸç”Ÿç»‘å®šï¼ˆå¯é€‰ï¼‰

```bash
# éœ€è¦å®‰è£… Rust toolchain ä¸ @napi-rs/cli
pnpm run build:native
```

æ„å»ºæˆåŠŸåä¼šåœ¨ `native/nervusdb-node/npm/<platform>/index.node` ç”Ÿæˆ N-API æ¨¡å—ã€‚è¿è¡Œç¯å¢ƒè‹¥æœªæ£€æµ‹åˆ°è¯¥æ¨¡å—ï¼ˆæˆ–è®¾ç½® `NERVUSDB_DISABLE_NATIVE=1`ï¼‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å›é€€åˆ° TypeScript å®ç°ã€‚
CI ä¼šåœ¨æ„å»ºé˜¶æ®µæ‰§è¡Œ `pnpm run build:native` ä¸é’ˆå¯¹åŸç”ŸåŠ è½½å™¨çš„ vitest å­é›†ï¼Œç¡®ä¿ Node å±‚éšæ—¶å¯ç”¨ã€‚

## è¿ç»´ä¸æ²»ç†å·¥å…·

| ç±»åˆ«     | å‘½ä»¤                                          | å…¸å‹åœºæ™¯                               |
| -------- | --------------------------------------------- | -------------------------------------- |
| è¯Šæ–­     | `nervusdb stats <db>`                         | ç»¼åˆç»Ÿè®¡ã€çƒ­åº¦ã€äº‹åŠ¡ IDã€é¡µåˆ†å¸ƒ        |
| æ ¡éªŒ     | `nervusdb check <db> [--strict]`              | ç´¢å¼•/manifest/WAL ä¸€è‡´æ€§æ ¡éªŒ           |
| ä¿®å¤     | `nervusdb repair <db> [--fast]`               | é¡µæ˜ å°„ä¿®å¤æˆ–é‡å»ºç´¢å¼•                   |
| å‹å®     | `nervusdb compact <db>`                       | æ‰‹åŠ¨æŒ‡å®š orders/pageSize/å‹ç¼©ç­–ç•¥      |
| è‡ªåŠ¨æ²»ç† | `nervusdb auto-compact <db>`                  | åŸºäºçƒ­åº¦/å¢“ç¢‘é˜ˆå€¼ï¼Œå¢é‡å‹å®å¹¶å¯è‡ªåŠ¨ GC |
| åƒåœ¾å›æ”¶ | `nervusdb gc <db> [--respect-readers]`        | æ¸…ç†å­¤é¡µä¸æ— å¼•ç”¨æ–‡ä»¶                   |
| çƒ­ç‚¹åˆ†æ | `nervusdb hot <db>`                           | è§‚å¯Ÿå¤šé¡µ primary / çƒ­åº¦æ’è¡Œ            |
| äº‹åŠ¡è§‚æµ‹ | `nervusdb txids <db>`                         | æŸ¥è¯¢/æ¸…ç†äº‹åŠ¡ ID æ³¨å†Œè¡¨                |
| å¯¼å‡ºè°ƒè¯• | `nervusdb dump <db> <order> <primary>`        | æŸ¥çœ‹æŒ‡å®šä¸»é”®æ‰€åœ¨é¡µå†…å®¹                 |
| é¡µçº§ä¿®å¤ | `nervusdb repair-page <db> <order> <primary>` | å¯¹å•ä¸ª primary é‡å»ºç´¢å¼•é¡µ              |

æ‰€æœ‰å‘½ä»¤åœ¨ `pnpm db:*` ä¸‹æœ‰ç­‰ä»·è„šæœ¬ã€‚

æ¨èè¿ç»´æµç¨‹ï¼š

1. æ—¥å¸¸è¿è¡Œï¼š`nervusdb stats` + `nervusdb hot`
2. å‘¨æœŸæ²»ç†ï¼š`nervusdb auto-compact` + `nervusdb gc`
3. æ•…éšœå¤„ç†ï¼š`nervusdb check --strict` â†’ `nervusdb repair`
4. äº‹åŠ¡ç›‘æ§ï¼š`nervusdb stats --txids` / `nervusdb txids`

## ç›‘æ§è¯Šæ–­ä¸å¯è§‚å¯Ÿæ€§

- **æ—¥å¿—**ï¼šCLI é»˜è®¤è¾“å‡º JSON-Like æ—¥å¿—ï¼Œå¯é‡å®šå‘åˆ°æ–‡ä»¶
- **ä¸´æ—¶ç›®å½•**ï¼š`tempfs.ts` å¸®åŠ©åœ¨æµ‹è¯•ä¸­éªŒè¯æŒä¹…åŒ–è¡Œä¸º
- **ç»Ÿè®¡é‡‡é›†**ï¼š`nervusdb stats` æ”¯æŒ `--txids-window` è§‚å¯Ÿäº‹åŠ¡é€Ÿç‡
- **çƒ­åº¦ä¸å¢“ç¢‘**ï¼š`hotness.json` / `index-manifest.json` å†…å«è¯¦ç»†æ•°æ®ï¼Œå¯è¾…åŠ©äºŒæ¬¡åˆ†æ
- **Benchmark æŠ¥è¡¨**ï¼š`benchmarks/*` è¾“å‡º TPSã€å»¶è¿Ÿã€å†…å­˜ã€é¡µåˆ†å¸ƒ
- **æ•…éšœæ³¨å…¥**ï¼š`src/utils/fault.ts` æ”¯æŒæ¨¡æ‹Ÿå¼‚å¸¸æµç¨‹

## é›†æˆæ¨¡å¼ä¸å®è·µ

- **åµŒå…¥åç«¯æœåŠ¡**ï¼šç›´æ¥åœ¨ Node.js æœåŠ¡ä¸­ `open()`ï¼Œç»“åˆ GraphQL/REST å±‚å°è£…æŸ¥è¯¢
- **CLI è‡ªåŠ¨åŒ–**ï¼šåœ¨ CI/CD æˆ–å®šæ—¶ä»»åŠ¡ä¸­æ‰§è¡Œ `nervusdb auto-compact`ã€`nervusdb stats --summary`
- **MCP/LLM ç”Ÿæ€**ï¼šé…åˆ `repomix` æ‰“åŒ…ä»£ç ï¼Œä½œä¸º AI åŠ©æ‰‹çš„çŸ¥è¯†è½½ä½“
- **VSCode æ‰©å±•**ï¼šå¯ä¸è‡ªå®šä¹‰å‘½ä»¤ç»„åˆï¼Œå®ç°ä¸€é”®å¯¼å‡º/åˆ†æ
- **æ•°æ®å¯¼å…¥/å¯¼å‡º**ï¼šä½¿ç”¨ `scripts/migrate-ndjson.mjs`ã€`benchmarks/*` æ„å»ºä¸“ç”¨ç®¡é“

## ç¤ºä¾‹ä¸å­¦ä¹ èµ„æº

- **å®˜æ–¹æ•™å­¦**ï¼š`docs/æ•™å­¦æ–‡æ¡£/`ï¼ˆæ•™ç¨‹ 00~09 + å®æˆ˜æ¡ˆä¾‹ï¼‰
- **æ“ä½œç¤ºä¾‹**ï¼š`docs/ä½¿ç”¨ç¤ºä¾‹/`ï¼ˆCLIã€æŸ¥è¯¢ã€äº‹åŠ¡ã€æµå¼ã€å›¾ç®—æ³•ã€è¿ç§»æŒ‡å—ç­‰ï¼‰
- **çŸ¥è¯†åº“**ï¼š`.qoder/repowiki/zh/content/` åˆ†ä¸“é¢˜æ·±å…¥è§£é‡Š
- **è·¯çº¿å›¾**ï¼š`docs/milestones/`ï¼ˆv1.1 ç³»åˆ—è§„åˆ’ï¼‰
- **æµ‹è¯•åˆ†å±‚**ï¼š`docs/æµ‹è¯•åˆ†å±‚ä¸è¿è¡ŒæŒ‡å—.md`
- **API/CLI é™„å½•**ï¼š`docs/æ•™å­¦æ–‡æ¡£/é™„å½•-APIå‚è€ƒ.md`ã€`docs/æ•™å­¦æ–‡æ¡£/é™„å½•-CLIå‚è€ƒ.md`
- **ä¸‹ä¸€æ­¥æ–¹å‘**ï¼š`NEXT_STEPS.md`ï¼ˆåŸºäºä»£ç ç°çŠ¶çš„å‘å±•è§„åˆ’ï¼‰

## å®‰å…¨å¤‡ä»½ä¸åˆè§„

- å¯ç”¨ `enableLock` é¿å…å¤šè¿›ç¨‹å¹¶å‘å†™
- å¤‡ä»½ç­–ç•¥ï¼šå¤åˆ¶ `<db>.nervusdb` + `<db>.nervusdb.pages/` + `<db>.nervusdb.wal`
- å»ºè®®åœ¨å¤‡ä»½å‰æ‰§è¡Œ `db.flush()` æˆ– `nervusdb auto-compact --auto-gc`
- äº‹åŠ¡ ID æ³¨å†Œè¡¨å¯åœ¨æ¢å¤åæ¸…ç†ï¼š`nervusdb txids <db> --clear`
- CLI é»˜è®¤å¯ç”¨è·¯å¾„æ ¡éªŒï¼Œé¿å…è¯¯å†™ç³»ç»Ÿç›®å½•
- ä¸è¦å°†çœŸå®å‡­æ®å†™å…¥å±æ€§ï¼›ä½¿ç”¨å¤–éƒ¨ç§˜é’¥ç®¡ç†

## è·¯çº¿å›¾ä¸ç‰ˆæœ¬ç­–ç•¥

- ç‰ˆæœ¬éµå¾ª SemVerï¼š`MAJOR.MINOR.PATCH`
- å½“å‰ç‰ˆæœ¬ï¼šv1.1.0ï¼ˆåŠŸèƒ½å®Œæ•´ã€æ€§èƒ½ä¼˜ç§€ï¼‰
- æ¯ä¸ªé‡Œç¨‹ç¢‘è¯¦è§ `docs/milestones/` ä¸ `CHANGELOG.md`
- ä¸‹ä¸€æ­¥æ–¹å‘ï¼š**çœŸå®åœºæ™¯éªŒè¯é©±åŠ¨çš„æ¼”è¿›**ï¼ˆè¯¦è§ `NEXT_STEPS.md`ï¼‰
  - Phase 1ï¼šé€‰æ‹©çœŸå®é¡¹ç›®éªŒè¯ï¼ˆä»£ç çŸ¥è¯†å›¾è°±/æ–‡æ¡£å…³è”/é…ç½®è¡€ç¼˜ï¼‰
  - Phase 2ï¼šåŸºäºéªŒè¯ç»“æœä¼˜åŒ–ï¼ˆç®€åŒ–/æ€§èƒ½/æ˜“ç”¨æ€§ï¼‰
  - Phase 3ï¼šä»£ç è´¨é‡æå‡ï¼ˆæµ‹è¯•å›å½’/æŒç»­é›†æˆä¼˜åŒ–ï¼‰

## å¸¸è§é—®é¢˜ FAQ

1. **ä¸ºä½•è¯»å–ä¸åˆ°åˆšå†™å…¥çš„æ•°æ®ï¼Ÿ**
   - å†™å…¥åæœª `flush()` æˆ–æœªåœ¨åŒä¸€å¿«ç…§å†…æŸ¥è¯¢ã€‚è°ƒç”¨ `db.flush()` æˆ–ä½¿ç”¨ `withSnapshot(fn)`ã€‚
2. **WAL æ–‡ä»¶æŒç»­å¢å¤§æ€ä¹ˆåŠï¼Ÿ**
   - å®šæœŸ `db.flush()`ï¼›æ‰§è¡Œ `nervusdb auto-compact` + `nervusdb gc` æ¸…ç†ã€‚
3. **å¤šèŠ‚ç‚¹éƒ¨ç½²å¦‚ä½•é¿å…å†²çªï¼Ÿ**
   - æ¯ä¸ªå®ä¾‹é…ç½®ç‹¬ç«‹è·¯å¾„ï¼›éœ€è¦å…±äº«åªè¯»æ—¶ï¼Œä¿æŒ `enableLock: false`ã€‚
4. **å±æ€§ç´¢å¼•æŸ¥è¯¢ä¸ºä»€ä¹ˆæ…¢ï¼Ÿ**
   - æ£€æŸ¥å±æ€§æ˜¯å¦ä¸ºç»“æ„åŒ– JSONï¼›åˆç†è®¾ç½®èŒƒå›´æŸ¥è¯¢ï¼›é¿å…è¿‡å¤§æ•°ç»„ã€‚
5. **è¯»å–æ—¶çœ‹åˆ°å†å²æ•°æ®ï¼Ÿ**
   - QueryBuilder é»˜è®¤ä½¿ç”¨æœ€æ–° manifestï¼›è‹¥å¯ç”¨å¿«ç…§å¹¶é•¿æ—¶é—´æ‰§è¡Œï¼Œå¯èƒ½ä»åœ¨æ—§ epoch ä¸­ã€‚
6. **GraphQL/Gremlin æŸ¥è¯¢æŠ›é”™ï¼Ÿ**
   - æ£€æŸ¥ schema åŠæŸ¥è¯¢è¯­æ³•æ˜¯å¦ç¬¦åˆæ”¯æŒèŒƒå›´ï¼›å‚è€ƒ `docs/ä½¿ç”¨ç¤ºä¾‹` ä¸­è¯­æ³•è¯´æ˜ã€‚
7. **å¦‚ä½•å¯¼å‡ºå…¨åº“ï¼Ÿ**
   - `nervusdb dump` + `scripts/dump-graph.mjs`ï¼›æˆ–ä½¿ç”¨ `repomix` æ‰“åŒ…é…åˆè¯´æ˜ã€‚
8. **å¦‚ä½•æ¥å…¥ç°æœ‰ç³»ç»Ÿï¼Ÿ**
   - å‚é˜… `docs/ä½¿ç”¨ç¤ºä¾‹/è¿ç§»æŒ‡å—-ä»Neo4jä¸TinkerGraph.md`ï¼Œæä¾›å­—æ®µæ˜ å°„ä¸è„šæœ¬æ¨¡æ¿ã€‚

## åŸºå‡†æµ‹è¯•ä¸æ€§èƒ½éªŒè¯

- `pnpm bench:baseline`ï¼šå¿«é€Ÿæ€§èƒ½å†’çƒŸéªŒè¯ï¼ˆæ’å…¥/æŸ¥è¯¢/è·¯å¾„/èšåˆï¼‰ã€‚
- `pnpm bench:temporal`ï¼šæ—¶é—´è®°å¿†åŸºå‡†ï¼›è¾“å‡ºç»“æœä¸æ‰©å±•è¯´æ˜è§ `docs/benchmarks/temporal-memory.md`ã€‚
- å…¶ä»–è„šæœ¬ä½äº `benchmarks/` ç›®å½•ï¼Œå¯æŒ‰éœ€æ‰©å±•æˆ–æ¥å…¥ CIã€‚
- æ—¶é—´è®°å¿†é»˜è®¤å¯ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼›è‹¥éœ€è‡ªå®šä¹‰è§£æï¼Œå¯è°ƒç”¨ `db.memory.ingestMessages()` æ¥å…¥è‡ªæœ‰æŠ½å–é€»è¾‘ã€‚

## å‚ä¸è´¡çŒ®ä¸æ”¯æŒ

- è´¡çŒ®æµç¨‹ï¼š
  1. Fork ä»“åº“
  2. å»ºç«‹ `feat/*` / `fix/*` åˆ†æ”¯
  3. ä¿®æ”¹å¹¶é€šè¿‡ `pnpm typecheck && pnpm lint && pnpm test && pnpm build`
  4. éµå¾ª Conventional Commits æ’°å†™æäº¤ä¿¡æ¯
  5. PR éœ€é™„éªŒè¯æ–¹å¼ä¸å½±å“é¢è¯´æ˜
- Issue ä¸è®¨è®ºï¼šæ¬¢è¿åœ¨ GitHub æäº¤é—®é¢˜ã€å»ºè®®æˆ–åˆ†äº«å®è·µ
- çŸ¥è¯†åº“ç»´æŠ¤ï¼šæ–°å¢ä¸“é¢˜è¯·åŒæ­¥æ›´æ–° `.qoder/repowiki/zh/meta/repowiki-metadata.json`
- æ¬¢è¿è´¡çŒ®ç¤ºä¾‹æ•°æ®ã€benchmark æŠ¥å‘Šæˆ–æ•™ç¨‹

## è®¸å¯è¯

- **ISC License**
- æäº¤ä»£ç å‰è¯·ç¡®è®¤ä¸åŒ…å«çœŸå®å‡­æ®ã€ç§é’¥æˆ–ç”Ÿäº§æ•°æ®
- ä»»ä½•åŸºäº NervusDB çš„åˆ†å‘è¯·ä¿ç•™åŸè®¸å¯è¯è¯´æ˜

---

> æ›´å¤šç»†èŠ‚è¯·å‚è€ƒ `docs/æ•™å­¦æ–‡æ¡£` ä¸ `docs/ä½¿ç”¨ç¤ºä¾‹` ç³»åˆ—æ–‡æ¡£ã€‚ä¿æŒ `pnpm test` ä¸ `repomix` ç»“æœä¸ºç»¿è‰²ï¼Œæ˜¯æ‰€æœ‰æ”¹åŠ¨çš„åŸºæœ¬å‡†çº¿ã€‚
